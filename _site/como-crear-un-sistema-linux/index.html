<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Cómo construir tu propio sistema Linux - Aitor      Ciberseguridad y Hacking Ético      </title>
<meta name="description" content="En este artículo, os enseño a crear vuestro propio sistema Linux desde cero, tomando completo control de las cosas que se instalan y arrancando el sistema como una nueva distribución.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Aitor | Ciberseguridad y Hacking Ético">
<meta property="og:title" content="Cómo construir tu propio sistema Linux">
<meta property="og:url" content="http://localhost:4000/como-crear-un-sistema-linux/">


  <meta property="og:description" content="En este artículo, os enseño a crear vuestro propio sistema Linux desde cero, tomando completo control de las cosas que se instalan y arrancando el sistema como una nueva distribución.">



  <meta property="og:image" content="http://localhost:4000/assets/images/s4viOS/s4viOS.png">





  <meta property="article:published_time" content="2020-04-23T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/como-crear-un-sistema-linux/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Aitorgg02",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Aitor | Ciberseguridad y Hacking Ético Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
                
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive/">Artículos</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categorías</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">Etiquetas</a>
            </li>
<li class="masthead__menu-item">
              <a href="/buscador/">Buscador</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Cómo construir tu propio sistema Linux</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="Aitorgg02" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Aitorgg02</h3>
    
    
      <p class="author__bio" itemprop="description">
        CyberSecurity and Web Developer
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/aitor-gonz%C3%A1lez-gonz%C3%A1lez-44b836189" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/aitorgg02" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Cómo construir tu propio sistema Linux">
    <meta itemprop="description" content="En este artículo, os enseño a crear vuestro propio sistema Linux desde cero, tomando completo control de las cosas que se instalan y arrancando el sistema como una nueva distribución.">
    <meta itemprop="datePublished" content="April 23, 2020">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Cómo construir tu propio sistema Linux
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2020-04-23T00:00:00+02:00">April 23, 2020 </time> 
          
          
        </p>
        <h1 id="cómo-construir-tu-propio-sistema-linux-s4vios">Cómo construir tu propio sistema Linux (S4viOS)</h1>

<p><img src="https://wallpaperaccess.com/full/981849.png" alt="Portada OS"></p>

<p>Antes que nada, deciros que toda esta guía la tenéis también disponible en mi Gist, desde donde os podéis dirigir directamente a través del índice a la sección que queráis:</p>

<ul>
  <li><a href="https://gist.github.com/s4vitar/8a2b18ec1f1b16226e21d4b89cbef270">https://gist.github.com/s4vitar/8a2b18ec1f1b16226e21d4b89cbef270</a></li>
</ul>

<p>Por alguna razón los eventos clickeables del índice desde esta página no son funcionales, así que cualquier cosa os podréis manejar por allí más cómodamente (No te olvides de dejar un Fav :P).</p>

<h2 id="índice-y-estructura-principal">Índice y Estructura Principal</h2>
<ul>
  <li><a href="#Antecedentes">Antecedentes</a></li>
  <li><a href="#Prerrequisitos">Prerrequisitos</a></li>
  <li>
<a href="#Introducci%C3%B3n">Introducción</a>
    <ul>
      <li><a href="#Consideraciones">Consideraciones</a></li>
      <li><a href="#Instalando-Debian-10.3.0">Instalando Debian 10.3.0</a></li>
      <li><a href="#Configurando-el-Debian-base">Configurando el Debian base</a></li>
      <li>
<a href="#instalaci%C3%B3n-de-paquetes-base">Instalación de paquetes base</a>
        <ul>
          <li><a href="#bash">Bash 3.2</a></li>
          <li><a href="#Binutils">Binutils 2.25</a></li>
          <li><a href="#Bison">Bison 2.7</a></li>
          <li><a href="#Bzip2">Bzip2 1.0.4</a></li>
          <li><a href="#Coreutils">Coreutils 6.9</a></li>
          <li><a href="#Diffutils">Diffutils 2.8.1</a></li>
          <li><a href="#Findutils">Findutils 4.2.31</a></li>
          <li><a href="#Gawk">Gawk 4.0.1</a></li>
          <li><a href="#gcc">GCC 6.2</a></li>
          <li><a href="#glibc">Glibc 2.11</a></li>
          <li><a href="#Grep">Grep 2.5.1</a></li>
          <li><a href="#Gzip">Gzip 1.3.12</a></li>
          <li><a href="#M4">M4 1.4.10</a></li>
          <li><a href="#Make">Make 4.0</a></li>
          <li><a href="#Patch">Patch 2.5.4</a></li>
          <li><a href="#Perl">Perl 5.8.8</a></li>
          <li><a href="#Python">Python 3.4</a></li>
          <li><a href="#Sed">Sed 4.1.5</a></li>
          <li><a href="#Tar">Tar 1.22</a></li>
          <li><a href="#Texinfo">Texinfo 4.7</a></li>
          <li><a href="#Xz">Xz 5.0.0</a></li>
        </ul>
      </li>
      <li><a href="#version-check">Version Check</a></li>
    </ul>
  </li>
  <li>
<a href="#creando-nueva-partici%C3%B3n">Creando nueva partición</a>
    <ul>
      <li><a href="#Estructurando-la-partici%C3%B3n-con-parted">Estructurando la partición con parted</a></li>
    </ul>
  </li>
  <li><a href="#Descarga-de-paquetes-para-la-creaci%C3%B3n-del-sistema-base">Descarga de paquetes para la creación del sistema base</a></li>
  <li>
<a href="#Construyendo-un-sistema-temporal">Construyendo un sistema temporal</a>
    <ul>
      <li><a href="#Creaci%C3%B3n-de-un-nuevo-usuario">Creación de un nuevo usuario</a></li>
      <li>
<a href="#Compilaci%C3%B3n-de-paquetes">Compilación de paquetes</a>
        <ul>
          <li><a href="#Compilaci%C3%B3n-binutils">Compilación binutils</a></li>
          <li><a href="#Compilaci%C3%B3n-GCC">Compilación GCC</a></li>
          <li><a href="#Compilaci%C3%B3n-API-Headers">Compilación API Headers</a></li>
          <li><a href="#Compilaci%C3%B3n-Glibc">Compilación Glibc</a></li>
          <li><a href="#Compilaci%C3%B3n-Libstdc-de-GCC">Compilación Libstdc++ de GCC</a></li>
          <li><a href="#Compilaci%C3%B3n-Binutils-Fase-2">Compilación Binutils Fase 2</a></li>
          <li><a href="#Compilaci%C3%B3n-GCC-Fase-2">Compilación GCC Fase 2</a></li>
          <li><a href="#Compilaci%C3%B3n-Tcl">Compilación Tcl</a></li>
          <li><a href="#Compilaci%C3%B3n-Expect">Compilación Expect</a></li>
          <li><a href="#Compilaci%C3%B3n-DejaGNU">Compilación DejaGNU</a></li>
          <li><a href="#Compilaci%C3%B3n-M4">Compilación M4</a></li>
          <li><a href="#Compilaci%C3%B3n-Ncurses">Compilación Ncurses</a></li>
          <li><a href="#Compilaci%C3%B3n-Bash">Compilación Bash</a></li>
          <li><a href="#Compilaci%C3%B3n-Bison">Compilación Bison</a></li>
          <li><a href="#Compilaci%C3%B3n-Bzip2">Compilación Bzip2</a></li>
          <li><a href="#Compilaci%C3%B3n-Coreutils">Compilación Coreutils</a></li>
          <li><a href="#Compilaci%C3%B3n-Diffutils">Compilación Diffutils</a></li>
          <li><a href="#Compilaci%C3%B3n-File">Compilación File</a></li>
          <li><a href="#Compilaci%C3%B3n-Findutils">Compilación Findutils</a></li>
          <li><a href="#Compilaci%C3%B3n-Gawk">Compilación Gawk</a></li>
          <li><a href="#Compilaci%C3%B3n-Gettext">Compilación Gettext</a></li>
          <li><a href="#Compilaci%C3%B3n-Grep">Compilación Grep</a></li>
          <li><a href="#Compilaci%C3%B3n-Gzip">Compilación Gzip</a></li>
          <li><a href="#Compilaci%C3%B3n-Make">Compilación Make</a></li>
          <li><a href="#Compilaci%C3%B3n-Patch">Compilación Patch</a></li>
          <li><a href="#Compilaci%C3%B3n-Perl">Compilación Perl</a></li>
          <li><a href="#Compilaci%C3%B3n-Python">Compilación Python</a></li>
          <li><a href="#Compilaci%C3%B3n-Sed">Compilación Sed</a></li>
          <li><a href="#Compilaci%C3%B3n-Tar">Compilación Tar</a></li>
          <li><a href="#Compilaci%C3%B3n-Texinfo">Compilación Texinfo</a></li>
          <li><a href="#Compilaci%C3%B3n-Xz">Compilación Xz</a></li>
        </ul>
      </li>
      <li><a href="#Stripping">Stripping</a></li>
      <li><a href="#Cambio-de-propietario">Cambio de propietario</a></li>
    </ul>
  </li>
  <li>
<a href="#Contruyendo-el-sistema-LFS">Construyendo el sistema LFS</a>
    <ul>
      <li><a href="#Preparando-el-sistema-de-archivos-del-kernel-virtual">Preparando el sistema de archivos del kernel virtual</a></li>
      <li><a href="#Montaje-del-sistema-de-archivos-del-kernel-virtual">Montaje del sistema de archivos del kernel virtual</a></li>
      <li>
<a href="#Entrando-en-el-entorno-Chroot">Entrando en el entorno Chroot</a>
        <ul>
          <li><a href="#Creaci%C3%B3n-de-directorios">Creación de directorios</a></li>
          <li><a href="#Creaci%C3%B3n-de-archivos-esenciales-y-links-simb%C3%B3licos">Creación de archivos esenciales y Links Simbólicos</a></li>
        </ul>
      </li>
      <li>
<a href="#Instalaci%C3%B3n-del-Software-b%C3%A1sico-del-sistema">Instalación del Software básico del sistema</a>
        <ul>
          <li><a href="#API-Headers-en-LFS">API Headers en LFS</a></li>
          <li><a href="#Man-pages-en-LFS">Man pages en LFS</a></li>
          <li><a href="#Glibc-en-LFS">Glibc en LFS</a></li>
          <li><a href="#Ajuste-de-la-Toolchain">Ajuste de la Toolchain</a></li>
          <li><a href="#Zlib-en-LFS">Zlib en LFS</a></li>
          <li><a href="#Bzip2-en-LFS">Bzip2 en LFS</a></li>
          <li><a href="#Xz-en-LFS">Xz en LFS</a></li>
          <li><a href="#File-en-LFS">File en LFS</a></li>
          <li><a href="#Readline-en-LFS">Readline en LFS</a></li>
          <li><a href="#M4-en-LFS">M4 en LFS</a></li>
          <li><a href="#Bc-en-LFS">Bc en LFS</a></li>
          <li><a href="#Binutils-en-LFS">Binutils en LFS</a></li>
          <li><a href="#GMP-en-LFS">GMP en LFS</a></li>
          <li><a href="#MPFR-en-LFS">MPFR en LFS</a></li>
          <li><a href="#MPC-en-LFS">MPC en LFS</a></li>
          <li><a href="#Attr-en-LFS">Attr en LFS</a></li>
          <li><a href="#Acl-en-LFS">Acl en LFS</a></li>
          <li><a href="#Instalaci%C3%B3n-del-Shadow">Instalación del Shadow</a></li>
          <li><a href="#GCC-en-LFS">GCC en LFS</a></li>
          <li><a href="#Pk-config-en-LFS">Pk-config en LFS</a></li>
          <li><a href="#Ncurses-en-LFS">Ncurses en LFS</a></li>
          <li><a href="#Sed-en-LFS">Sed en LFS</a></li>
          <li><a href="#Psmisc-en-LFS">Psmisc en LFS</a></li>
          <li><a href="#Iana-Etc-en-LFS">Iana Etc en LFS</a></li>
          <li><a href="#Bison-en-LFS">Bison en LFS</a></li>
          <li><a href="#Flex-en-LFS">Flex en LFS</a></li>
          <li><a href="#Grep-en-LFS">Grep en LFS</a></li>
          <li><a href="#Bash-en-LFS">Bash en LFS</a></li>
          <li><a href="#Libtool-en-LFS">Libtool en LFS</a></li>
          <li><a href="#GDBM-en-LFS">GDBM en LFS</a></li>
          <li><a href="#Gperf-en-LFS">Gperf en LFS</a></li>
          <li><a href="#Expat-en-LFS">Expat en LFS</a></li>
          <li><a href="#Inetutils-en-LFS">Inetutils en LFS</a></li>
          <li><a href="#Perl-en-LFS">Perl en LFS</a></li>
          <li><a href="#XML-Parser-en-LFS">XML::Parser en LFS</a></li>
          <li><a href="#Intltool-en-LFS">Intltool en LFS</a></li>
          <li><a href="#Autoconf-en-LFS">Autoconf en LFS</a></li>
          <li><a href="#Automake-en-LFS">Automake en LFS</a></li>
          <li><a href="#Kmod-en-LFS">Kmod en LFS</a></li>
          <li><a href="#Gettext-en-LFS">Gettext en LFS</a></li>
          <li><a href="#Libelf-de-elfutils-en-LFS">Libelf de Elfutils en LFS</a></li>
          <li><a href="#Libffi-en-LFS">Libffi en LFS</a></li>
          <li><a href="#Openssl-en-LFS">Openssl en LFS</a></li>
          <li><a href="#Python3-en-LFS">Python3 en LFS</a></li>
          <li><a href="#Ninja-en-LFS">Ninja en LFS</a></li>
          <li><a href="#Meson-en-LFS">Meson en LFS</a></li>
          <li><a href="#Coreutils-en-LFS">Coreutils en LFS</a></li>
          <li><a href="#Check-en-LFS">Check en LFS</a></li>
          <li><a href="#Diffutils-en-LFS">Diffutils en LFS</a></li>
          <li><a href="#Gawk-en-LFS">Gawk en LFS</a></li>
          <li><a href="#Findutils-en-LFS">Findutils en LFS</a></li>
          <li><a href="#Groff-en-LFS">Groff en LFS</a></li>
          <li><a href="#GRUB-en-LFS">GRUB en LFS</a></li>
          <li><a href="#Less-en-LFS">Less en LFS</a></li>
          <li><a href="#Gzip-en-LFS">Gzip en LFS</a></li>
          <li><a href="#Zstd-en-LFS">Zstd en LFS</a></li>
          <li><a href="#IPRoute-en-LFS">IPRoute en LFS</a></li>
          <li><a href="#Kbd-en-LFS">Kbd en LFS</a></li>
          <li><a href="#Libpipeline-en-LFS">Libpipeline en LFS</a></li>
          <li><a href="#Make-en-LFS">Make en LFS</a></li>
          <li><a href="#Patch-en-LFS">Patch en LFS</a></li>
          <li><a href="#Man-DB-en-LFS">Man DB en LFS</a></li>
          <li><a href="#Tar-en-LFS">Tar en LFS</a></li>
          <li><a href="#Texinfo-en-LFS">Texinfo en LFS</a></li>
          <li><a href="#Vim-en-LFS">Vim en LFS</a></li>
          <li><a href="#Procps-en-LFS">Procps-ng en LFS</a></li>
          <li><a href="#Util-Linux-en-LFS">Util-Linux en LFS</a></li>
          <li><a href="#E2fsprogs-en-LFS">E2fsprogs en LFS</a></li>
          <li><a href="#Sysklogd-en-LFS">Sysklogd en LFS</a></li>
          <li><a href="#Sysvinit-en-LFS">Sysvinit en LFS</a></li>
          <li><a href="#Eudev-en-LFS">Eudev en LFS</a></li>
        </ul>
      </li>
      <li><a href="#Limpieza-Final">Limpieza Final</a></li>
      <li>
<a href="#Configuraci%C3%B3n-del-sistema">Configuración del sistema</a>
        <ul>
          <li><a href="#Instalaci%C3%B3n-de-LFS-Bootscripts">Instalación de LFS Bootscripts</a></li>
          <li><a href="#Gesti%C3%B3n-de-dispositivos">Gestión de dispositivos</a></li>
          <li><a href="#Creaci%C3%B3n-de-archivos-de-configuraci%C3%B3n-de-interfaz-de-red">Creación de archivos de configuración de interfaz de red</a></li>
          <li><a href="#Configurando-el-nombre-de-host-del-sistema">Configurando el nombre de host del sistema</a></li>
          <li><a href="#Configurando-el-sysvinit">Configurando el Sysvinit</a></li>
          <li><a href="#Configuraci%C3%B3n-del-reloj-del-sistema">Configuración del reloj del sistema</a></li>
          <li><a href="#Configuraci%C3%B3n-de-la-consola-de-linux">Configuración de la consola de Linux</a></li>
          <li><a href="#Creando-archivo-rc-site">Creando archivo rc.site</a></li>
        </ul>
      </li>
      <li><a href="#Archivos-de-inicio-de-Bash-Shell">Archivos de inicio de Bash Shell</a></li>
    </ul>
  </li>
  <li>
<a href="#Haciendo-nuestro-sistema-booteable">Haciendo nuestro sistema Booteable</a>
    <ul>
      <li><a href="#Creando-archivo-fstab">Creando archivo fstab</a></li>
      <li><a href="#Instalaci%C3%B3n-del-kernel">Instalación del Kernel</a></li>
      <li><a href="#Uso-del-grub-para-configurar-el-proceso-de-arranque">Uso del GRUB para configurar el proceso de arranque</a></li>
    </ul>
  </li>
  <li><a href="#Creando-archivos-finales">Creando archivos finales</a></li>
  <li><a href="#Arrancando-nuestra-nueva-distribuci%C3%B3n-Linux-S4viOS">Arrancando nuestra nueva distribución Linux S4viOS</a></li>
</ul>

<h1 id="antecedentes">Antecedentes</h1>
<p>Antes que nada, me gustaría comentar una serie de puntos para aquellos que pretenden seguir esta guía.</p>

<h4 id="por-qué-crear-un-sistema-linux-desde-0-manualmente-en-vez-de-descargar-e-instalar-uno-existente">¿Por qué crear un sistema Linux desde 0 manualmente en vez de descargar e instalar uno existente?</h4>

<p>Bueno, si te estás haciendo esta pregunta es que lo tuyo no es la curiosidad.</p>

<p>La idea de esta guía es que te sirva de ayuda para entender y aprender cómo funciona un sistema Linux desde adentro hacia afuera. Construir un sistema LFS desde 0 te ayuda a entender qué hace que Linux funcione y cómo las cosas funcionan a bajo nivel.</p>

<p>Aparte, una de las mejores cosas que se pueden sacar de provecho de todo esto es la capacidad de personalizar un sistema Linux para satisfacer tus propias necesidades únicas. No me considero un paranoico, pero en muchas distribuciones Linux no es la primera vez que me encuentro con un binario ya previamente compilado cuyo código no puedo ver (por no ser Open Source)… y a saber qué lleva dentro, igual hasta viene con regalo.</p>

<p>En ese sentido, tal vez por pura prevención (y curiosidad), a veces es mejor tener el control de qué cosas son las que se están instalando en el sistema, ¿no crees?.</p>

<h4 id="prerrequisitos">Prerrequisitos</h4>

<p>Construir un sistema LFS no es una tarea simple. Para toda esta guía, se requiere un cierto nivel de conocimiento existente sobre la administración del sistema Unix. Si esto es así y se aplica para tu caso… a por ello.</p>

<p>Otro de los requisitos que se requieren es la <strong>paciencia</strong>. Construir un sistema LFS no se hace en un día (creedme, lo he intentado), algunos paquetes tardan mucho en instalarse y hay algunas fases que de por sí requieren de tiempo.</p>

<p>El tiempo estimado para construir tu propio sistema Linux oscila entre <strong>3 y 5 días</strong>, para que lo tengáis en cuenta.</p>

<h1 id="introducción">INTRODUCCIÓN</h1>
<h4 id="consideraciones">Consideraciones</h4>

<p>Bueno antes de empezar, deciros que en mi caso voy a estar trabajando con VirtualBox.</p>

<p>La pregunta que probablemente os hagáis es, ¿y no puedo usar VMware?, pues a ver, por poder podéis… PERO de las veces que he probado con VMware, justo en la fase final a la hora de hacer el Reboot… aparece un <strong>Kernel Panic</strong>, con el cual me estuve peleando en su momento y no encontré forma de arreglarlo.</p>

<p>Si queréis no tener que estar lidiando con estos problemas, mi recomendación es que lo hagáis todo con <strong>Virtual Box</strong>. Por lo demás, hay que tener en cuenta que para construir tu propio sistema Linux, necesitas primero de una distribución Linux de base sobre la que trabajar, ya que es desde esta desde donde estaremos toqueteando nuestro nuevo disco duro virtual que posteriormente crearemos.</p>

<p>En mi caso, estaré trabajando con un <strong>Debian 10.3.0 amd64</strong>, el cual puedes descargar desde la página oficial:</p>

<ul>
  <li>https://www.debian.org/distrib/netinst</li>
</ul>

<h4 id="instalando-debian-1030">Instalando Debian 10.3.0</h4>

<p>Una vez descargado el ISO, lo único que tendremos que hacer es lo siguiente.</p>

<p align="center">
     <img src="https://funkyimg.com/i/346m7.png">
</p>
<p><br></p>

<p>Es decir, comenzamos creando una nueva máquina virtual. Posteriormente, le asignamos un nombre e indicamos el tipo de sistema operativo con el que estamos tratando así como la versión:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346mT.png">
</p>
<p><br></p>

<p>Una vez hecho, indicamos un tamaño de memoria. En mi caso, asignaré <strong>4096 MB</strong> de memoria:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346mU.png">
</p>
<p><br></p>

<p>En el siguiente paso, crearemos un nuevo disco duro virtual:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346mV.png">
</p>
<p><br></p>

<p>En la selección del tipo de archivo de disco duro, usaremos <strong>VDI</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346n3.png">
</p>
<p><br></p>

<p>En la especificación de almacenamiento en unidad de disco duro física escogeremos <strong>Tamaño fijo</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346n1.png">
</p>
<p><br></p>

<p>Y por último, asignaremos un total de <strong>30 GB</strong> para nuestro disco duro virtual:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346n2.png">
</p>
<p><br></p>

<p>Una vez finalizado, lo único que tendremos que hacer es dirigirnos a las propiedades de nuestra nueva máquina e importar la ISO de nuestro Debian (la que previamente hemos descargado).</p>

<p>Esto se hace desde la siguiente sección:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346nf.png">
</p>
<p><br></p>

<p>Ya con todo esto hecho, debería salirnos algo como esto:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346nj.png">
</p>
<p><br></p>

<p>En este punto, lo único que tendremos que hacer ya es arrancar la máquina y comenzar con la fase de instalación.</p>

<p>Seleccionaremos el idioma:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346nt.png">
</p>
<p><br></p>

<p>Desde aquí, habrá que rellenar una serie de datos de ubicación que no creo que haga falta añadir en este Gist (es puro sentido común y no creo que tenga pérdida).</p>

<p>En la especificación de nombre de máquina, yo pondré <strong>Debian</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346o3.png">
</p>
<p><br></p>

<p>Cuando nos pregunten por el nombre de dominio, simplemente dejad este campo en blanco:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346o2.png">
</p>
<p><br></p>

<p>Rellenad en el siguiente paso vuestra clave de superusuario:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346o4.png">
</p>
<p><br></p>

<p>Tanto en el nombre de usuario como en el nombre de cuenta, como es de obviar… especificaremos nuestro usuario identificativo:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346oe.png">
</p>
<p><br></p>

<p>Y como es de esperar, nuestra contraseña (para no liarnos yo siempre recomiendo que sea la misma que la clave del superusuario):</p>

<p align="center">
     <img src="https://funkyimg.com/i/346od.png">
</p>
<p><br></p>

<p>Ya con esta fase terminada, se nos preguntará por la zona horaria y nuestra ubicación, aquí que cada uno rellene los datos que considere.</p>

<p>En el particionado de discos, escogeremos la opción de usar todo el disco:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346or.png">
</p>
<p><br></p>

<p>Deberíamos ver posteriormente algo como esto:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346os.png">
</p>
<p><br></p>

<p>Una vez hecho, en nuestro caso el esquema de particionado será con todos los ficheros en una partición (posteriormente en nuestro sistema Linux el esquema de particionado será con el /home en otra partición, pero por ahora en nuestro Debian base lo haremos así de simple):</p>

<p align="center">
     <img src="https://funkyimg.com/i/346ot.png">
</p>
<p><br></p>

<p>Por último, aplicamos todos los cambios seleccionando la opción ‘<strong>Finalizar el particionado</strong>’:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346ou.png">
</p>
<p><br></p>

<p>Seleccionaremos la opción <strong>Sí</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346oL.png">
</p>
<p><br></p>

<p>En caso de que nos pregunte por otro CD a utilizar, le diremos que no:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346oR.png">
</p>
<p><br></p>

<p>Y en caso de que nos pregunte por las réplicas de red, de la misma forma seleccionaremos la opción <strong>No</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346oU.png">
</p>
<p><br></p>

<p>En la selección de programas, nosotros estaremos trabajando con entorno gráfico para estar más cómodos, por tanto… seleccionaremos las siguientes opciones a instalar:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346p2.png">
</p>
<p><br></p>

<p>Esta fase puede durar unos minutos. Nos preguntará si queremos instalar el cargador de arranque (GRUB), le diremos que sí:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346ps.png">
</p>
<p><br></p>

<p>Asimismo, indicaremos el dispositivo donde queremos instalar el cargador de arranque, en este caso <strong>/dev/sda</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346pu.png">
</p>
<p><br></p>

<p>Ya llegados a este punto, habríamos finalizado con toda la fase de instalación y debería salirnos un recuadro como este:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346pV.png">
</p>
<p><br></p>

<p>Al presionar en ‘<strong>Continuar</strong>’, nuestro Debian debería arrancar sin mayor inconveniente hasta llegar al entorno gráfico:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346q5.png">
</p>
<p><br></p>

<p>Dado que las proporciones no son las correctas y estaríamos trabajando con una ventana muy chiquita, en el siguiente punto veremos cómo instalar las <strong>VBox Linux Additions</strong>.</p>

<h4 id="configurando-el-debian-base">Configurando el Debian base</h4>

<p>Antes de instalar las <strong>Linux Additions</strong> para poder trabajar de manera cómoda, lo que haremos será retocar una línea del archivo <strong>/etc/apt/sources.list</strong>.</p>

<p>Comentaremos la línea que empieza por ‘<strong>deb cdrom</strong>’, ya que esta de no estar comentada hace que se nos paren las compilaciones más adelante y estaremos trabajando de manera incómoda:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346qT.png">
</p>
<p><br></p>

<p>De la misma forma, descomentaremos las 2 últimas líneas y antes de estas añadiremos un nuevo <strong>deb</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346rL.png">
</p>
<p><br></p>

<p>Una vez hecho, aplicaremos el siguiente comando a nivel de sistema:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt update
</code></pre></div></div>

<p>Obteniendo el siguiente output por consola:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346rM.png">
</p>
<p><br></p>

<p>Esta parte es fundamental pues de lo contrario no nos encontrará los paquetes <strong>build-essential</strong> y <strong>linux-headers-amd64</strong>, necesarios para instalar las <strong>VBoxLinuxAdditions</strong>.</p>

<p>Aplicamos los siguientes comandos como el usuario <strong>root</strong> para instalar lo previamente citado:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt <span class="nb">install </span>build-essential linux-headers-amd64 <span class="nt">-y</span>
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/346sw.png">
</p>
<p><br></p>

<p>Este proceso puede tardar unos minutos.</p>

<p>Ahora bien, ¿cómo hacemos para instalar las <strong>VBoxLinuxAdditions</strong>?. En VirtualBox, en la parte superior, contamos con esta utilidad:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346t7.png">
</p>
<p><br></p>

<p>Al presionarla, desde nuestra máquina virtual deberemos ver lo siguiente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346t8.png">
</p>
<p><br></p>

<p>En este punto, deberíamos presionar en ‘Ejecutar’. Si vemos un fallo… es normal, no nos asustemos.</p>

<p>Lo que haremos será de forma manual atender a la siguiente ruta:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346t9.png">
</p>
<p><br></p>

<p>Eso sí, dado que en esta montura tenemos permisos únicamente de lectura, lo que haremos será crearnos una copia del archivo <strong>VBoxLinuxAdditions.run</strong>, posteriormente le daremos permisos de ejecución y lo ejecutaremos con bash:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346tH.png">
</p>
<p><br></p>

<p>Para concluir, aplicamos un <strong>reboot</strong> de la siguiente forma:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346tM.png">
</p>
<p><br></p>

<p>Una vez reiniciado nuestro Debian, el entorno gráfico se nos debería cargar perfectamente en pantalla completa sin mayor inconveniente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346tX.png">
</p>
<p><br></p>

<h4 id="instalación-de-paquetes-base">Instalación de paquetes base</h4>

<p>Lo que haremos a continuación será crear el siguiente script:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> version-check.sh &lt;&lt; <span class="s2">"EOF"</span>
<span class="c">#!/bin/bash</span>
<span class="c"># Simple script to list version numbers of critical development tools</span>
<span class="nb">export </span><span class="nv">LC_ALL</span><span class="o">=</span>C
bash <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f2-4</span>
<span class="nv">MYSH</span><span class="o">=</span><span class="si">$(</span><span class="nb">readlink</span> <span class="nt">-f</span> /bin/sh<span class="si">)</span>
<span class="nb">echo</span> <span class="s2">"/bin/sh -&gt; </span><span class="nv">$MYSH</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="nv">$MYSH</span> | <span class="nb">grep</span> <span class="nt">-q</span> bash <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"ERROR: /bin/sh does not point to bash"</span>
<span class="nb">unset </span>MYSH

<span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Binutils: "</span><span class="p">;</span> ld <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f3-</span>
bison <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-h</span> /usr/bin/yacc <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"/usr/bin/yacc -&gt; </span><span class="sb">`</span><span class="nb">readlink</span> <span class="nt">-f</span> /usr/bin/yacc<span class="sb">`</span><span class="s2">"</span><span class="p">;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nt">-x</span> /usr/bin/yacc <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo </span>yacc is <span class="sb">`</span>/usr/bin/yacc <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="sb">`</span>
<span class="k">else
  </span><span class="nb">echo</span> <span class="s2">"yacc not found"</span> 
<span class="k">fi

</span>bzip2 <span class="nt">--version</span> 2&gt;&amp;1 &lt; /dev/null | <span class="nb">head</span> <span class="nt">-n1</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f1</span>,6-
<span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Coreutils: "</span><span class="p">;</span> <span class="nb">chown</span> <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">")"</span> <span class="nt">-f2</span>
diff <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
find <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
gawk <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-h</span> /usr/bin/awk <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"/usr/bin/awk -&gt; </span><span class="sb">`</span><span class="nb">readlink</span> <span class="nt">-f</span> /usr/bin/awk<span class="sb">`</span><span class="s2">"</span><span class="p">;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nt">-x</span> /usr/bin/awk <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo awk </span>is <span class="sb">`</span>/usr/bin/awk <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="sb">`</span>
<span class="k">else 
  </span><span class="nb">echo</span> <span class="s2">"awk not found"</span> 
<span class="k">fi

</span>gcc <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
g++ <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
ldd <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f2-</span>  <span class="c"># glibc version</span>
<span class="nb">grep</span> <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
<span class="nb">gzip</span> <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
<span class="nb">cat</span> /proc/version
m4 <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
make <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
patch <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
<span class="nb">echo </span>Perl <span class="sb">`</span>perl <span class="nt">-V</span>:version<span class="sb">`</span>
python3 <span class="nt">--version</span>
<span class="nb">sed</span> <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
<span class="nb">tar</span> <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>
makeinfo <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>  <span class="c"># texinfo version</span>
xz <span class="nt">--version</span> | <span class="nb">head</span> <span class="nt">-n1</span>

<span class="nb">echo</span> <span class="s1">'int main(){}'</span> <span class="o">&gt;</span> dummy.c <span class="o">&amp;&amp;</span> g++ <span class="nt">-o</span> dummy dummy.c
<span class="k">if</span> <span class="o">[</span> <span class="nt">-x</span> dummy <span class="o">]</span>
  <span class="k">then </span><span class="nb">echo</span> <span class="s2">"g++ compilation OK"</span><span class="p">;</span>
  <span class="k">else </span><span class="nb">echo</span> <span class="s2">"g++ compilation failed"</span><span class="p">;</span> <span class="k">fi
</span><span class="nb">rm</span> <span class="nt">-f</span> dummy.c dummy
EOF
</code></pre></div></div>

<p>Tras su ejecución, lo normal es obtener errores como los que se listan a continuación:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346vL.png">
</p>
<p><br></p>

<p>Esto es así dado que vamos a tener que ir instalando una serie de dependencias así como de enlaces simbólicos hasta que la ejecución de este script nos diga que está todo correcto. Lo utilizaremos como Checker.</p>

<p>Lo que haremos será seguir la siguiente filosofía:</p>

<ul>
  <li>Si el paquete se encuentra instalado, instalaremos el dev [siempre y cuando el paquete disponga del dev]. Si no se encuentra instalado, instalaremos el paquete y el dev.</li>
</ul>

<p>¿Qué es esto del dev?, bueno… cada paquete (no todos), suelen venir con una paquetería de desarrollador (-dev o -devel). Estos paquetes adicionales de desarrollador son necesarios para que todo el proceso de construcción de nuestro sistema Linux vaya correctamente.</p>

<h5 id="bash">Bash</h5>

<p>Empezaremos por el paquete Bash. Haremos la siguiente comprobación:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346wb.png">
</p>
<p><br></p>

<p>En este caso, vemos que el paquete ya lo tenía instalado en el sistema. El paquete <strong>Bash</strong> no cuenta con paquetería de desarrollador, por tanto… lo único que aplico conforme a la validación del script que previamente habíamos ejecutado, es un enlace simbólico para que la ‘<strong>/bin/sh</strong>’ apunte a una <strong>Bash</strong>.</p>

<h5 id="binutils">Binutils</h5>

<p>Validamos de la misma forma e instalamos su correspondiente paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346wE.png">
</p>
<p><br></p>

<h5 id="bison">Bison</h5>

<p>Este paquete no se debería de encontrar instalado en el sistema, por tanto… instalamos y a la vez instalamos su paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346wM.png">
</p>
<p><br></p>

<h5 id="bzip2">Bzip2</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346x2.png">
</p>
<p><br></p>

<h5 id="coreutils">Coreutils</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346x8.png">
</p>
<p><br></p>

<h5 id="diffutils">Diffutils</h5>

<p>Se encuentra instalado en el sistema y no posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346xB.png">
</p>
<p><br></p>

<h5 id="findutils">Findutils</h5>

<p>Se encuentra instalado en el sistema y no posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346xC.png">
</p>
<p><br></p>

<h5 id="gawk">Gawk</h5>

<p>Se encuentra instalado en el sistema y no posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346xV.png">
</p>
<p><br></p>

<h5 id="gcc">Gcc</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346yf.png">
</p>
<p><br></p>

<h5 id="glibc">Glibc</h5>

<p>No se encuentra instalado en el sistema y no posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346yk.png">
</p>
<p><br></p>

<h5 id="grep">Grep</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346yD.png">
</p>
<p><br></p>

<h5 id="gzip">Gzip</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346yE.png">
</p>
<p><br></p>

<h5 id="m4">M4</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346zX.png">
</p>
<p><br></p>

<h5 id="make">Make</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346A7.png">
</p>
<p><br></p>

<h5 id="patch">Patch</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Ad.png">
</p>
<p><br></p>

<h5 id="perl">Perl</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Ak.png">
</p>
<p><br></p>

<h5 id="python">Python</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Ax.png">
</p>
<p><br></p>

<h5 id="sed">Sed</h5>

<p>Se encuentra instalado en el sistema y no posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Ay.png">
</p>
<p><br></p>

<h5 id="tar">Tar</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346AD.png">
</p>
<p><br></p>

<h5 id="texinfo">Texinfo</h5>

<p>No se encuentra instalado en el sistema y no posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346By.png">
</p>
<p><br></p>

<h5 id="xz">Xz</h5>

<p>Se encuentra instalado en el sistema y posee paquetería de desarrollador:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346AN.png">
</p>
<p><br></p>

<h4 id="version-check">Version Check</h4>

<p>Una vez instalados todos los paquetes, ejecutaremos los siguientes comandos para crear una serie de links simbólicos necesarios para que todo funcione correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-svf</span> bison /usr/bin/yacc
<span class="nb">ln</span> <span class="nt">-svf</span> gawk /usr/bin/awk
</code></pre></div></div>

<p>Ya con esto hecho, ejecutaremos el script <strong>version-check.sh</strong> previamente creado y analizamos si nos da algún error:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346BS.png">
</p>
<p><br></p>

<p>Como vemos, no se nos reporta ningún error… por lo que podremos continuar. Si en este punto se te arroja algún error, es que has metido la pata en algún sitio y no has instalado correctamente algún paquete necesario.</p>

<p>¿Mi recomendación en este punto?, crea una instantánea, no vaya a ser que en breve la líes y tengas que volver a empezar desde 0… así por lo menos te das el margen de empezar desde aquí:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346C9.png">
</p>
<p><br></p>

<h1 id="creando-nueva-partición">Creando nueva partición</h1>

<p>En este punto, ya con todo lo anterior correctamente configurado, lo que haremos será apagar la máquina virtual. Nos iremos a la configuración de nuestra máquina, y añadiremos un nuevo disco… donde irá el LFS:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Dx.png">
</p>
<p>&lt;br</p>

<p>Una vez más, será de tipo <strong>VDI</strong>. En la selección del tipo de almacenamiento en unidad de disco duro física, indicaremos que queremos trabajar con un tamaño fijo:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Dy.png">
</p>
<p><br></p>

<p>Posteriormente, identificamos el <strong>VDI</strong> donde irá nuestro nuevo sistema Linux con un nombre descriptivo. Yo lo llamaré <strong>S4viOS</strong> (30 GB):</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Dz.png">
</p>
<p><br></p>

<p>Una vez creado, lo que hacemos es añadirlo justo debajo del ya existente correspondiente al Debian:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346DA.png">
</p>
<p><br></p>

<p>Una vez añadido, debería verse tal que así:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346DB.png">
</p>
<p><br></p>

<p>Si arrancamos el Debian, todo debería continuar funcionando correctamente.</p>

<p>Al aplicar el comando <strong>lsblk</strong>, deberíamos ver una nueva partición en <strong>/dev/sdb</strong>, correspondiente a la que hemos creado para <strong>S4viOS</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346DC.png">
</p>
<p><br></p>

<p><strong>¡Importante en este punto antes de continuar!</strong>, como de aquí en adelante es probable que nos encontremos con fases de larga espera, lo mejor es quitar esto que nos sale cuando estamos inactivos:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346EU.png">
</p>
<p><br></p>

<p>No creo que nos haga mucha gracia que en una plena instalación se nos apague de pronto el equipo por inactividad. Para quitar este modo, buscamos ‘<strong>Energía</strong>’ en el buscador de herramientas, y ponemos la siguiente configuración:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346F1.png">
</p>
<p><br></p>

<h4 id="estructurando-la-partición-con-parted">Estructurando la partición con parted</h4>

<p>Lo que tenemos que pensar en este punto es lo siguiente, vamos a echar de nuevo un ojo a nuestras particiones:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346DC.png">
</p>
<p><br></p>

<p>La idea en este punto es dejar <strong>sdb</strong> tal y como se ve <strong>sda</strong>, con el mismo esquema de particiones con la diferencia de que yo en este caso añadiré una partición aparte adicional para el <strong>/home</strong> de nuestro sistema S4viOS por separado.</p>

<p>Esto lo podemos hacer desde <strong>parted</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Hr.png">
</p>
<p><br></p>

<p>En este caso, lo único que he hecho ha sido seleccionar la partición con la que quiero trabajar (<strong>sdb</strong>) y he analizado sus propiedades con <strong>print</strong>.</p>

<p>Si os fijáis, no detecta el label de la tabla de particiones. Vamos a echar un ojo a las propiedades de la partición <strong>sda</strong> ya existente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Hq.png">
</p>
<p><br></p>

<p>En este caso el label corresponde a <strong>msdos</strong>. Pues la idea es replicar el mismo “escenario”, por tanto… volveremos a nuestra partición <strong>sdb</strong> y aplicaremos estos cambios en el label:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Hs.png">
</p>
<p><br></p>

<p>Tras volver a hacer un <strong>print</strong>, en este caso ya vemos cómo se lista la información correctamente.</p>

<p>Ahora bien, lo dicho… iremos creando una serie de particiones, tanto primarias, como extendidas, como lógicas en función de cómo lo queramos nosotros organizar. En mi caso lo organizaré de la siguiente forma:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Ht.png">
</p>
<p><br></p>

<p>Como vemos, las Flags para cada una de las particiones están identificadas como <strong>lba</strong>, y en la partición <strong>sda</strong> si lo verificáis veréis como esto no es así, únicamente está representada la partición primaria con el Flag <strong>boot</strong>.</p>

<p>Pues nosotros haremos lo mismo, es decir… copiaremos el esquema:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Hu.png">
</p>
<p><br></p>

<p>En este punto, lo que recomiendo es comparar <strong>sda</strong> con <strong>sdb</strong> para ver si siguen la misma estructura:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Hv.png">
</p>
<p><br></p>

<p>Ahora bien, en cuanto a particiones respecta… deberíamos ver algo como esto en estos instantes:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Hw.png">
</p>
<p><br></p>

<p>Como podréis apreciar, aún no hay UUID’s identificativos para las particiones <strong>sdb1, sdb5 y sdb6</strong>. Esto es normal, dado que para ello previamente tenemos que asignar un filesystem a cada una de ellas:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Jt.png">
</p>
<p><br></p>

<p>Ya con esto hecho, a través del comando <code class="language-plaintext highlighter-rouge">lsblk -f</code> podremos sacar los respectivos UUID’s de cada una de las particiones. De todas formas, hay un modo más cómodo que sería el siguiente sobre las particiones que nos interesan:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Jw.png">
</p>
<p><br></p>

<p>¿Qué hacemos con estos UUID’s?, pues configurarlos en el ‘<strong>/etc/fstab</strong>’. Este archivo, por defecto debería alojar el siguiente contenido:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Ju.png">
</p>
<p><br></p>

<p>Pues lo que nosotros haremos será justamente lo mismo pero para nuestra partición:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Jv.png">
</p>
<p><br></p>

<p>La raíz de nuestro sistema Linux S4viOS estará definido por la partición primaria, y será desde ‘<em>/mnt/lfs</em>’ donde configuraremos la raíz (aunque ese directorio aún no exista, no nos preocupemos… lo crearemos en breve siguiendo este esquema).</p>

<p>Por otro lado, especificamos el UUID del SWAP, que correspondería al espacio de intercambio y por último el UUID de la partición que asignaremos a la ‘<strong>/home</strong>’ accesible desde nuestro equipo Debian en ‘<em>/mnt/lfs/home</em>’.</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Jx.png">
</p>
<p><br></p>

<p>En este punto, creamos los respectivos directorios definidos en el ‘<strong>/etc/fstab</strong>’, montamos las particiones en dichas rutas y jugamos con <strong>swapon</strong>, ampliamente usado para habilitar/deshabilitar dispositivos y archivos para paginación e intercambio, en este caso sobre nuestro SWAP (<strong>/dev/sdb5</strong>).</p>

<p>Finalmente, si hacemos un <code class="language-plaintext highlighter-rouge">lsblk</code> tal y como se aprecia en la imagen de arriba, deberíamos ver esa misma estructura de particiones. Si esto es así, podremos continuar con las siguientes fases, ¡pero no sin antes crear otra Snapshot!, que nunca se sabe:</p>

<p align="center">
     <img src="https://funkyimg.com/i/346Jy.png">
</p>
<p><br></p>

<h1 id="descarga-de-paquetes-para-la-creación-del-sistema-base">Descarga de paquetes para la creación del sistema base</h1>

<p>Comenzaremos creándonos un directorio en ‘<em>$LFS/sources</em>’:</p>

<p align="center">
     <img src="https://funkyimg.com/i/347Pv.png">
</p>
<p><br></p>

<p>Desde aquí, tendremos que descargar una serie de paquetes los cuales tendremos que ir descomprimiendo y compilando poco a poco.</p>

<p>Para trabajar rápido, haremos lo siguiente, crearéis un archivo <code class="language-plaintext highlighter-rouge">wget-list</code> con el siguiente contenido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://download.savannah.gnu.org/releases/attr/attr-2.4.48.tar.gz
http://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.xz
http://ftp.gnu.org/gnu/automake/automake-1.16.1.tar.xz
http://ftp.gnu.org/gnu/bash/bash-5.0.tar.gz
https://github.com/gavinhoward/bc/archive/2.5.3/bc-2.5.3.tar.gz
http://ftp.gnu.org/gnu/binutils/binutils-2.34.tar.xz
http://ftp.gnu.org/gnu/bison/bison-3.5.2.tar.xz
https://www.sourceware.org/pub/bzip2/bzip2-1.0.8.tar.gz
https://github.com/libcheck/check/releases/download/0.14.0/check-0.14.0.tar.gz
http://ftp.gnu.org/gnu/coreutils/coreutils-8.31.tar.xz
http://ftp.gnu.org/gnu/dejagnu/dejagnu-1.6.2.tar.gz
http://ftp.gnu.org/gnu/diffutils/diffutils-3.7.tar.xz
https://downloads.sourceforge.net/project/e2fsprogs/e2fsprogs/v1.45.5/e2fsprogs-1.45.5.tar.gz
https://sourceware.org/ftp/elfutils/0.178/elfutils-0.178.tar.bz2
http://download.savannah.gnu.org/releases/acl/acl-2.2.53.tar.gz
https://dev.gentoo.org/~blueness/eudev/eudev-3.2.9.tar.gz
https://prdownloads.sourceforge.net/expat/expat-2.2.9.tar.xz
https://prdownloads.sourceforge.net/expect/expect5.45.4.tar.gz
ftp://ftp.astron.com/pub/file/file-5.38.tar.gz
http://ftp.gnu.org/gnu/findutils/findutils-4.7.0.tar.xz
https://github.com/westes/flex/releases/download/v2.6.4/flex-2.6.4.tar.gz
http://ftp.gnu.org/gnu/gawk/gawk-5.0.1.tar.xz
http://ftp.gnu.org/gnu/gcc/gcc-9.2.0/gcc-9.2.0.tar.xz
http://ftp.gnu.org/gnu/gdbm/gdbm-1.18.1.tar.gz
http://ftp.gnu.org/gnu/gettext/gettext-0.20.1.tar.xz
http://ftp.gnu.org/gnu/glibc/glibc-2.31.tar.xz
http://ftp.gnu.org/gnu/gmp/gmp-6.2.0.tar.xz
http://ftp.gnu.org/gnu/gperf/gperf-3.1.tar.gz
http://ftp.gnu.org/gnu/grep/grep-3.4.tar.xz
http://ftp.gnu.org/gnu/groff/groff-1.22.4.tar.gz
https://ftp.gnu.org/gnu/grub/grub-2.04.tar.xz
http://ftp.gnu.org/gnu/gzip/gzip-1.10.tar.xz
http://anduin.linuxfromscratch.org/LFS/iana-etc-2.30.tar.bz2
http://ftp.gnu.org/gnu/inetutils/inetutils-1.9.4.tar.xz
https://launchpad.net/intltool/trunk/0.51.0/+download/intltool-0.51.0.tar.gz
https://www.kernel.org/pub/linux/utils/net/iproute2/iproute2-5.5.0.tar.xz
https://www.kernel.org/pub/linux/utils/kbd/kbd-2.2.0.tar.xz
https://www.kernel.org/pub/linux/utils/kernel/kmod/kmod-26.tar.xz
http://www.greenwoodsoftware.com/less/less-551.tar.gz
http://www.linuxfromscratch.org/lfs/downloads/9.1/lfs-bootscripts-20191031.tar.xz
https://www.kernel.org/pub/linux/libs/security/linux-privs/libcap2/libcap-2.31.tar.xz
ftp://sourceware.org/pub/libffi/libffi-3.3.tar.gz
http://download.savannah.gnu.org/releases/libpipeline/libpipeline-1.5.2.tar.gz
http://ftp.gnu.org/gnu/libtool/libtool-2.4.6.tar.xz
https://www.kernel.org/pub/linux/kernel/v5.x/linux-5.5.3.tar.xz
http://ftp.gnu.org/gnu/m4/m4-1.4.18.tar.xz
http://ftp.gnu.org/gnu/make/make-4.3.tar.gz
http://download.savannah.gnu.org/releases/man-db/man-db-2.9.0.tar.xz
https://www.kernel.org/pub/linux/docs/man-pages/man-pages-5.05.tar.xz
https://github.com/mesonbuild/meson/releases/download/0.53.1/meson-0.53.1.tar.gz
https://ftp.gnu.org/gnu/mpc/mpc-1.1.0.tar.gz
http://www.mpfr.org/mpfr-4.0.2/mpfr-4.0.2.tar.xz
https://github.com/ninja-build/ninja/archive/v1.10.0/ninja-1.10.0.tar.gz
http://ftp.gnu.org/gnu/ncurses/ncurses-6.2.tar.gz
https://www.openssl.org/source/openssl-1.1.1d.tar.gz
http://ftp.gnu.org/gnu/patch/patch-2.7.6.tar.xz
https://www.cpan.org/src/5.0/perl-5.30.1.tar.xz
https://pkg-config.freedesktop.org/releases/pkg-config-0.29.2.tar.gz
https://sourceforge.net/projects/procps-ng/files/Production/procps-ng-3.3.15.tar.xz
https://sourceforge.net/projects/psmisc/files/psmisc/psmisc-23.2.tar.xz
https://www.python.org/ftp/python/3.8.1/Python-3.8.1.tar.xz
https://www.python.org/ftp/python/doc/3.8.1/python-3.8.1-docs-html.tar.bz2
http://ftp.gnu.org/gnu/readline/readline-8.0.tar.gz
http://ftp.gnu.org/gnu/sed/sed-4.8.tar.xz
https://github.com/shadow-maint/shadow/releases/download/4.8.1/shadow-4.8.1.tar.xz
http://www.infodrom.org/projects/sysklogd/download/sysklogd-1.5.1.tar.gz
http://download.savannah.gnu.org/releases/sysvinit/sysvinit-2.96.tar.xz
http://ftp.gnu.org/gnu/tar/tar-1.32.tar.xz
https://downloads.sourceforge.net/tcl/tcl8.6.10-src.tar.gz
http://ftp.gnu.org/gnu/texinfo/texinfo-6.7.tar.xz
https://www.iana.org/time-zones/repository/releases/tzdata2019c.tar.gz
http://anduin.linuxfromscratch.org/LFS/udev-lfs-20171102.tar.xz
https://www.kernel.org/pub/linux/utils/util-linux/v2.35/util-linux-2.35.1.tar.xz
http://anduin.linuxfromscratch.org/LFS/vim-8.2.0190.tar.gz
https://cpan.metacpan.org/authors/id/T/TO/TODDR/XML-Parser-2.46.tar.gz
https://tukaani.org/xz/xz-5.2.4.tar.xz
https://zlib.net/zlib-1.2.11.tar.xz
https://github.com/facebook/zstd/releases/download/v1.4.4/zstd-1.4.4.tar.gz
http://www.linuxfromscratch.org/patches/lfs/9.1/bash-5.0-upstream_fixes-1.patch
http://www.linuxfromscratch.org/patches/lfs/9.1/bzip2-1.0.8-install_docs-1.patch
http://www.linuxfromscratch.org/patches/lfs/9.1/coreutils-8.31-i18n-1.patch
http://www.linuxfromscratch.org/patches/lfs/9.1/glibc-2.31-fhs-1.patch
http://www.linuxfromscratch.org/patches/lfs/9.1/kbd-2.2.0-backspace-1.patch
http://www.linuxfromscratch.org/patches/lfs/9.1/sysvinit-2.96-consolidated-1.patch
</code></pre></div></div>

<p>De nada. Una vez hecho, lo único que tendréis que hacer es ejecutar el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget <span class="nt">--input-file</span><span class="o">=</span>wget-list <span class="nt">--continue</span> <span class="nt">--directory-prefix</span><span class="o">=</span><span class="nv">$LFS</span>/sources
</code></pre></div></div>

<p>Este proceso puede tardar un buen rato… así que te recomiendo que salgas a dar una vuelta o a despejarte.</p>

<p align="center">
     <img src="https://funkyimg.com/i/347Qa.png">
</p>
<p><br></p>

<p>Nos situaremos en el directorio ‘<em>$LFS/sources</em>’, deberíamos ver algo como esto una vez finalizado:</p>

<p align="center">
     <img src="https://funkyimg.com/i/3483C.png">
</p>
<p><br></p>

<p>Es decir, deberíamos tener todos los recursos en un principio descargados.</p>

<h1 id="construyendo-un-sistema-temporal">Construyendo un sistema temporal</h1>

<h4 id="creación-de-un-nuevo-usuario">Creación de un nuevo usuario</h4>

<p>En este punto, comenzaremos creando un directorio <code class="language-plaintext highlighter-rouge">tools</code> en ‘<em>$LFS/tools/</em>’, posteriormente… crearemos un usuario a nivel de sistema con nombre <code class="language-plaintext highlighter-rouge">lfs</code>, ejecutando para ello los siguientes comandos:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34852.png">
</p>
<p><br></p>

<p>Será necesario proporcionar una contraseña para el nuevo usuario <code class="language-plaintext highlighter-rouge">lfs</code>.</p>

<p>Una vez hecho, retocaremos el <code class="language-plaintext highlighter-rouge">.bash_profile</code> y el <code class="language-plaintext highlighter-rouge">.bashrc</code> de este nuevo usuario, adaptando el siguiente contenido:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34853.png">
</p>
<p><br></p>

<p>Ya con esto definido, aplicamos un <code class="language-plaintext highlighter-rouge">source</code> sobre estos 2 archivos y ya podremos continuar:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34854.png">
</p>
<p><br></p>

<h4 id="compilación-de-paquetes">Compilación de paquetes</h4>

<p>En este punto, será necesario compilar una serie de paquetes de los previamente descargados a través del archivo <code class="language-plaintext highlighter-rouge">wget-list</code>. Recomiendo tener esta guía abierta para copiar y pegar algunos de los comandos, pues estos en ocasiones son algo largos.</p>

<h5 id="compilación-binutils">Compilación binutils</h5>

<p>Para comenzar con la compilación de este paquete, lo que haremos será dirigirnos a la ruta ‘<em>$LFS/sources</em>’, descomprimiremos el archivo <code class="language-plaintext highlighter-rouge">binutils-2.34.tar.xz</code>, nos meteremos dentro de este y ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd </span>build

../configure <span class="nt">--prefix</span><span class="o">=</span>/tools            <span class="se">\</span>
             <span class="nt">--with-sysroot</span><span class="o">=</span><span class="nv">$LFS</span>        <span class="se">\</span>
             <span class="nt">--with-lib-path</span><span class="o">=</span>/tools/lib <span class="se">\</span>
             <span class="nt">--target</span><span class="o">=</span><span class="nv">$LFS_TGT</span>          <span class="se">\</span>
             <span class="nt">--disable-nls</span>              <span class="se">\</span>
             <span class="nt">--disable-werror</span>

make

<span class="k">case</span> <span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span> <span class="k">in
  </span>x86_64<span class="p">)</span> <span class="nb">mkdir</span> <span class="nt">-v</span> /tools/lib <span class="o">&amp;&amp;</span> <span class="nb">ln</span> <span class="nt">-sv</span> lib /tools/lib64 <span class="p">;;</span>
<span class="k">esac</span>

make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, ya tendríamos esta utilidad instalada… y lo único que tendríamos que hacer es retroceder a nivel de directorios y borrar el mismo:</p>

<p align="center">
     <img src="https://funkyimg.com/i/3486D.png">
</p>
<p><br></p>

<h5 id="compilación-gcc">Compilación GCC</h5>

<p>Este paquete depende a su vez de otros 3 paquetes, así que tras su descompresión, haremos lo siguiente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/3486N.png">
</p>
<p><br></p>

<p>Por aquí os dejo los comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar</span> <span class="nt">-xf</span> gcc-9.2.0.tar.xz

<span class="nb">cd </span>gcc-9.2.0

<span class="nb">tar</span> <span class="nt">-xf</span> ../mpfr-4.0.2.tar.xz
<span class="nb">mv</span> <span class="nt">-v</span> mpfr-4.0.2 mpfr
<span class="nb">tar</span> <span class="nt">-xf</span> ../gmp-6.2.0.tar.xz
<span class="nb">mv</span> <span class="nt">-v</span> gmp-6.2.0 gmp
<span class="nb">tar</span> <span class="nt">-xf</span> ../mpc-1.1.0.tar.gz
<span class="nb">mv</span> <span class="nt">-v</span> mpc-1.1.0 mpc
</code></pre></div></div>

<p>Una vez hecho, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>file <span class="k">in </span>gcc/config/<span class="o">{</span>linux,i386/linux<span class="o">{</span>,64<span class="o">}}</span>.h
<span class="k">do
  </span><span class="nb">cp</span> <span class="nt">-uv</span> <span class="nv">$file</span><span class="o">{</span>,.orig<span class="o">}</span>
  <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s@/lib\(64\)\?\(32\)\?/ld@/tools&amp;@g'</span> <span class="se">\</span>
      <span class="nt">-e</span> <span class="s1">'s@/usr@/tools@g'</span> <span class="nv">$file</span>.orig <span class="o">&gt;</span> <span class="nv">$file</span>
  <span class="nb">echo</span> <span class="s1">'
#undef STANDARD_STARTFILE_PREFIX_1
#undef STANDARD_STARTFILE_PREFIX_2
#define STANDARD_STARTFILE_PREFIX_1 "/tools/lib/"
#define STANDARD_STARTFILE_PREFIX_2 ""'</span> <span class="o">&gt;&gt;</span> <span class="nv">$file</span>
  <span class="nb">touch</span> <span class="nv">$file</span>.orig
<span class="k">done

case</span> <span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span> <span class="k">in
  </span>x86_64<span class="p">)</span>
    <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'/m64=/s/lib64/lib/'</span> <span class="se">\</span>
        <span class="nt">-i</span>.orig gcc/config/i386/t-linux64
 <span class="p">;;</span>
<span class="k">esac</span>

<span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd </span>build

../configure                                       <span class="se">\</span>
    <span class="nt">--target</span><span class="o">=</span><span class="nv">$LFS_TGT</span>                              <span class="se">\</span>
    <span class="nt">--prefix</span><span class="o">=</span>/tools                                <span class="se">\</span>
    <span class="nt">--with-glibc-version</span><span class="o">=</span>2.11                      <span class="se">\</span>
    <span class="nt">--with-sysroot</span><span class="o">=</span><span class="nv">$LFS</span>                            <span class="se">\</span>
    <span class="nt">--with-newlib</span>                                  <span class="se">\</span>
    <span class="nt">--without-headers</span>                              <span class="se">\</span>
    <span class="nt">--with-local-prefix</span><span class="o">=</span>/tools                     <span class="se">\</span>
    <span class="nt">--with-native-system-header-dir</span><span class="o">=</span>/tools/include <span class="se">\</span>
    <span class="nt">--disable-nls</span>                                  <span class="se">\</span>
    <span class="nt">--disable-shared</span>                               <span class="se">\</span>
    <span class="nt">--disable-multilib</span>                             <span class="se">\</span>
    <span class="nt">--disable-decimal-float</span>                        <span class="se">\</span>
    <span class="nt">--disable-threads</span>                              <span class="se">\</span>
    <span class="nt">--disable-libatomic</span>                            <span class="se">\</span>
    <span class="nt">--disable-libgomp</span>                              <span class="se">\</span>
    <span class="nt">--disable-libquadmath</span>                          <span class="se">\</span>
    <span class="nt">--disable-libssp</span>                               <span class="se">\</span>
    <span class="nt">--disable-libvtv</span>                               <span class="se">\</span>
    <span class="nt">--disable-libstdcxx</span>                            <span class="se">\</span>
    <span class="nt">--enable-languages</span><span class="o">=</span>c,c++

make
make <span class="nb">install</span>
</code></pre></div></div>

<p><strong>Anotación</strong>: Este paquete puede tardar un poco en instalarse, así que paciencia.</p>

<p>Una vez instalado, podremos retroceder a nivel de directorios y borrar el recurso descomprimido sin mayor inconveniente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/3489L.png">
</p>
<p><br></p>

<h5 id="compilación-api-headers">Compilación API Headers</h5>

<p>En este caso, descomprimiremos el archivo <code class="language-plaintext highlighter-rouge">linux-5.5.3.tar.xz</code> y ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make mrproper
make headers
<span class="nb">cp</span> <span class="nt">-rv</span> usr/include/<span class="k">*</span> /tools/include
<span class="nb">cd</span> ..
<span class="nb">rm</span> <span class="nt">-rf</span> linux-5.5.3
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/348ac.png">
</p>
<p><br></p>

<h5 id="compilación-glibc">Compilación Glibc</h5>

<p>Para la instalación de <strong>Glibc</strong>, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar</span> <span class="nt">-xf</span> glibc-2.31.tar.xz
<span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd       </span>build

../configure                             <span class="se">\</span>
      <span class="nt">--prefix</span><span class="o">=</span>/tools                    <span class="se">\</span>
      <span class="nt">--host</span><span class="o">=</span><span class="nv">$LFS_TGT</span>                    <span class="se">\</span>
      <span class="nt">--build</span><span class="o">=</span><span class="si">$(</span>../scripts/config.guess<span class="si">)</span> <span class="se">\</span>
      <span class="nt">--enable-kernel</span><span class="o">=</span>3.2                <span class="se">\</span>
      <span class="nt">--with-headers</span><span class="o">=</span>/tools/include

make
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, aplicaremos el siguiente comando para validar que las funciones básicas (compilación y linking) de la nueva toolchain están trabajando correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'int main(){}'</span> <span class="o">&gt;</span> dummy.c
<span class="nv">$LFS_TGT</span><span class="nt">-gcc</span> dummy.c
readelf <span class="nt">-l</span> a.out | <span class="nb">grep</span> <span class="s1">': /tools'</span>
</code></pre></div></div>

<p>Si al ejecutarlo nos sale el siguiente mensaje:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>Requesting program interpreter: /tools/lib64/ld-linux-x86-64.so.2]
</code></pre></div></div>

<p>Entonces nos podremos quedar tranquilos. Posteriormente, borramos estos archivos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-v</span> dummy.c a.out
<span class="nb">cd</span> ../..
<span class="nb">rm</span> <span class="nt">-rf</span> glibc-2.31
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/348ei.png">
</p>
<p><br></p>

<p>Ojo cuidado, ¡hagamos una Snapshot que ya hemos avanzado considerablemente!:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348ev.png">
</p>
<p><br></p>

<h5 id="compilación-libstdc-de-gcc">Compilación Libstdc de GCC</h5>

<p>Para instalar esta utilidad, necesitaremos volver a descomprimir el archivo <code class="language-plaintext highlighter-rouge">gcc-9.2.0.tar.xz</code> una vez más. Una vez hecho, aplicaremos los siguientes comandos dentro del directorio descomprimido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd </span>build

../libstdc++-v3/configure           <span class="se">\</span>
    <span class="nt">--host</span><span class="o">=</span><span class="nv">$LFS_TGT</span>                 <span class="se">\</span>
    <span class="nt">--prefix</span><span class="o">=</span>/tools                 <span class="se">\</span>
    <span class="nt">--disable-multilib</span>              <span class="se">\</span>
    <span class="nt">--disable-nls</span>                   <span class="se">\</span>
    <span class="nt">--disable-libstdcxx-threads</span>     <span class="se">\</span>
    <span class="nt">--disable-libstdcxx-pch</span>         <span class="se">\</span>
    <span class="nt">--with-gxx-include-dir</span><span class="o">=</span>/tools/<span class="nv">$LFS_TGT</span>/include/c++/9.2.0

make
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizado, como siempre… retrocedemos 2 directorios y borramos el directorio:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348kG.png">
</p>
<p><br></p>

<h5 id="compilación-binutils-fase-2">Compilación Binutils Fase 2</h5>

<p>Una vez más, volveremos a descomprimir el comprimido <code class="language-plaintext highlighter-rouge">binutils-2.34.tar.xz</code> y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar</span> <span class="nt">-xf</span> binutils-2.34.tar.xz
<span class="nb">cd </span>binutils-2.34

<span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd </span>build

<span class="nv">CC</span><span class="o">=</span><span class="nv">$LFS_TGT</span><span class="nt">-gcc</span>                <span class="se">\</span>
<span class="nv">AR</span><span class="o">=</span><span class="nv">$LFS_TGT</span><span class="nt">-ar</span>                 <span class="se">\</span>
<span class="nv">RANLIB</span><span class="o">=</span><span class="nv">$LFS_TGT</span><span class="nt">-ranlib</span>         <span class="se">\</span>
../configure                   <span class="se">\</span>
    <span class="nt">--prefix</span><span class="o">=</span>/tools            <span class="se">\</span>
    <span class="nt">--disable-nls</span>              <span class="se">\</span>
    <span class="nt">--disable-werror</span>           <span class="se">\</span>
    <span class="nt">--with-lib-path</span><span class="o">=</span>/tools/lib <span class="se">\</span>
    <span class="nt">--with-sysroot</span>

make
make <span class="nb">install

</span>make <span class="nt">-C</span> ld clean
make <span class="nt">-C</span> ld <span class="nv">LIB_PATH</span><span class="o">=</span>/usr/lib:/lib
<span class="nb">cp</span> <span class="nt">-v</span> ld/ld-new /tools/bin
</code></pre></div></div>

<p>Una vez hecho, la misma historia de siempre… retrocedemos 2 directorios y borramos el directorio:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348nQ.png">
</p>
<p><br></p>

<h5 id="compilación-gcc-fase-2">Compilación GCC Fase 2</h5>

<p>Descomprimiremos una vez más el archivo <code class="language-plaintext highlighter-rouge">gcc-9.2.0.tar.xz</code> y aplicaremos los siguientes comandos a nivel de sistema:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>gcc/limitx.h gcc/glimits.h gcc/limity.h <span class="o">&gt;</span> <span class="se">\</span>
  <span class="sb">`</span><span class="nb">dirname</span> <span class="si">$(</span><span class="nv">$LFS_TGT</span><span class="nt">-gcc</span> <span class="nt">-print-libgcc-file-name</span><span class="si">)</span><span class="sb">`</span>/include-fixed/limits.h

<span class="k">for </span>file <span class="k">in </span>gcc/config/<span class="o">{</span>linux,i386/linux<span class="o">{</span>,64<span class="o">}}</span>.h
<span class="k">do
  </span><span class="nb">cp</span> <span class="nt">-uv</span> <span class="nv">$file</span><span class="o">{</span>,.orig<span class="o">}</span>
  <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s@/lib\(64\)\?\(32\)\?/ld@/tools&amp;@g'</span> <span class="se">\</span>
      <span class="nt">-e</span> <span class="s1">'s@/usr@/tools@g'</span> <span class="nv">$file</span>.orig <span class="o">&gt;</span> <span class="nv">$file</span>
  <span class="nb">echo</span> <span class="s1">'
#undef STANDARD_STARTFILE_PREFIX_1
#undef STANDARD_STARTFILE_PREFIX_2
#define STANDARD_STARTFILE_PREFIX_1 "/tools/lib/"
#define STANDARD_STARTFILE_PREFIX_2 ""'</span> <span class="o">&gt;&gt;</span> <span class="nv">$file</span>
  <span class="nb">touch</span> <span class="nv">$file</span>.orig
<span class="k">done

case</span> <span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span> <span class="k">in
  </span>x86_64<span class="p">)</span>
    <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'/m64=/s/lib64/lib/'</span> <span class="se">\</span>
        <span class="nt">-i</span>.orig gcc/config/i386/t-linux64
  <span class="p">;;</span>
<span class="k">esac</span>

<span class="nb">tar</span> <span class="nt">-xf</span> ../mpfr-4.0.2.tar.xz
<span class="nb">mv</span> <span class="nt">-v</span> mpfr-4.0.2 mpfr
<span class="nb">tar</span> <span class="nt">-xf</span> ../gmp-6.2.0.tar.xz
<span class="nb">mv</span> <span class="nt">-v</span> gmp-6.2.0 gmp
<span class="nb">tar</span> <span class="nt">-xf</span> ../mpc-1.1.0.tar.gz
<span class="nb">mv</span> <span class="nt">-v</span> mpc-1.1.0 mpc

<span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'1161 s|^|//|'</span> <span class="se">\</span>
    <span class="nt">-i</span> libsanitizer/sanitizer_common/sanitizer_platform_limits_posix.cc

<span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd </span>build
</code></pre></div></div>

<p>Toda esta parte debería devolver un output limpio como el siguiente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348ou.png">
</p>
<p><br></p>

<p>Llegados a este punto ejecutamos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CC</span><span class="o">=</span><span class="nv">$LFS_TGT</span><span class="nt">-gcc</span>                                    <span class="se">\</span>
<span class="nv">CXX</span><span class="o">=</span><span class="nv">$LFS_TGT</span><span class="nt">-g</span>++                                   <span class="se">\</span>
<span class="nv">AR</span><span class="o">=</span><span class="nv">$LFS_TGT</span><span class="nt">-ar</span>                                     <span class="se">\</span>
<span class="nv">RANLIB</span><span class="o">=</span><span class="nv">$LFS_TGT</span><span class="nt">-ranlib</span>                             <span class="se">\</span>
../configure                                       <span class="se">\</span>
    <span class="nt">--prefix</span><span class="o">=</span>/tools                                <span class="se">\</span>
    <span class="nt">--with-local-prefix</span><span class="o">=</span>/tools                     <span class="se">\</span>
    <span class="nt">--with-native-system-header-dir</span><span class="o">=</span>/tools/include <span class="se">\</span>
    <span class="nt">--enable-languages</span><span class="o">=</span>c,c++                       <span class="se">\</span>
    <span class="nt">--disable-libstdcxx-pch</span>                        <span class="se">\</span>
    <span class="nt">--disable-multilib</span>                             <span class="se">\</span>
    <span class="nt">--disable-bootstrap</span>                            <span class="se">\</span>
    <span class="nt">--disable-libgomp</span>

make
make <span class="nb">install
ln</span> <span class="nt">-sv</span> gcc /tools/bin/cc
</code></pre></div></div>

<p>Igual que hicimos la primera vez, tendremos que validar que las funciones básicas (compilación y linking) de la nueva toolchain están funcionando correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'int main(){}'</span> <span class="o">&gt;</span> dummy.c
cc dummy.c
readelf <span class="nt">-l</span> a.out | <span class="nb">grep</span> <span class="s1">': /tools'</span>
</code></pre></div></div>

<p>Teniendo que ver un output como el siguiente:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>Requesting program interpreter: /tools/lib64/ld-linux-x86-64.so.2]
</code></pre></div></div>

<p>Si eso es así, buen trabajo. Eliminamos los ficheros y directorios innecesarios:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-v</span> dummy.c a.out
<span class="nb">cd</span> ../..
<span class="nb">rm</span> <span class="nt">-rf</span> gcc-9.2.0
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/348qv.png">
</p>
<p><br></p>

<h5 id="compilación-tcl">Compilación Tcl</h5>

<p>Para la instalación de este paquete, tendremos que descomprimir el comprimido <code class="language-plaintext highlighter-rouge">tcl8.6.10-src.tar.gz</code>. Posteriormente, ejecutaremos los siguientes comandos dentro del directorio:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>unix

./configure <span class="nt">--prefix</span><span class="o">=</span>/tools

make
<span class="nv">TZ</span><span class="o">=</span>UTC make <span class="nb">test
</span>make <span class="nb">install

chmod</span> <span class="nt">-v</span> u+w /tools/lib/libtcl8.6.so
make install-private-headers
<span class="nb">ln</span> <span class="nt">-sv</span> tclsh8.6 /tools/bin/tclsh
</code></pre></div></div>

<p>Una vez terminado, retrocedemos 2 directorios y borramos el directorio:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348rB.png">
</p>
<p><br></p>

<h5 id="compilación-expect">Compilación Expect</h5>

<p>Para la instalación de este paquete, tendremos que descomprimir el comprimido <code class="language-plaintext highlighter-rouge">expect5.45.4.tar.gz</code>, posteriormente, ejecutaremos los siguientes comandos dentro del directorio:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> <span class="nt">-v</span> configure<span class="o">{</span>,.orig<span class="o">}</span>
<span class="nb">sed</span> <span class="s1">'s:/usr/local/bin:/bin:'</span> configure.orig <span class="o">&gt;</span> configure

./configure <span class="nt">--prefix</span><span class="o">=</span>/tools       <span class="se">\</span>
            <span class="nt">--with-tcl</span><span class="o">=</span>/tools/lib <span class="se">\</span>
            <span class="nt">--with-tclinclude</span><span class="o">=</span>/tools/include

make
make <span class="nb">test
</span>make <span class="nv">SCRIPTS</span><span class="o">=</span><span class="s2">""</span> <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizado, retrocedemos 1 directorio y borramos el directorio principal:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348s6.png">
</p>
<p><br></p>

<h5 id="compilación-dejagnu">Compilación DejaGNU</h5>

<p>La instalación de este paquete es bastante rápida. En primer lugar, descomprimimos el comprimido <code class="language-plaintext highlighter-rouge">dejagnu-1.6.2.tar.gz</code>. Posteriormente, ejecutamos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make <span class="nb">install
</span>make check
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348sm.png">
</p>
<p><br></p>

<h5 id="compilación-m4">Compilación M4</h5>

<p>Para instalar este paquete, descomprimiremos el comprimido <code class="language-plaintext highlighter-rouge">m4-1.4.18.tar.xz</code>, nos meteremos en el directorio descomprimido y efectuaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/IO_ftrylockfile/IO_EOF_SEEN/'</span> lib/<span class="k">*</span>.c
<span class="nb">echo</span> <span class="s2">"#define _IO_IN_BACKUP 0x100"</span> <span class="o">&gt;&gt;</span> lib/stdio-impl.h

./configure <span class="nt">--prefix</span><span class="o">=</span>/tools

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Durante el <code class="language-plaintext highlighter-rouge">make check</code>, deberíamos ver algo como esto:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348tc.png">
</p>
<p><br></p>

<p>Una vez finalizada la instalación, retrocedemos un directorio y borramos el directorio principal:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348td.png">
</p>
<p><br></p>

<h5 id="compilación-ncurses">Compilación Ncurses</h5>

<p>Para instalar este paquete, necesitaremos descomprimir el comprimido con nombre <code class="language-plaintext highlighter-rouge">ncurses-6.2.tar.gz</code>. Una vez hecho, aplicaremos los siguientes comandos dentro del directorio descomprimido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> s/mawk// configure

./configure <span class="nt">--prefix</span><span class="o">=</span>/tools <span class="se">\</span>
            <span class="nt">--with-shared</span>   <span class="se">\</span>
            <span class="nt">--without-debug</span> <span class="se">\</span>
            <span class="nt">--without-ada</span>   <span class="se">\</span>
            <span class="nt">--enable-widec</span>  <span class="se">\</span>
            <span class="nt">--enable-overwrite</span>

make
make <span class="nb">install
ln</span> <span class="nt">-s</span> libncursesw.so /tools/lib/libncurses.so
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Ncurses.</p>

<h5 id="compilación-bash">Compilación Bash</h5>

<p>Para instalar este paquete, necesitaremos descomprimir el comprimido con nombre <code class="language-plaintext highlighter-rouge">bash-5.0.tar.gz</code>. Una vez hecho, ejecutaremos los siguientes comandos dentro del directorio descomprimido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools <span class="nt">--without-bash-malloc</span>
make
make tests
make <span class="nb">install
ln</span> <span class="nt">-sv</span> bash /tools/bin/sh
</code></pre></div></div>

<p>Una vez hecho, retrocederemos un directorio y borraremos el directorio principal de Bash:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348v6.png">
</p>
<p><br></p>

<h5 id="compilación-bison">Compilación Bison</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">bison-3.5.2.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Bison:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348w3.png">
</p>
<p><br></p>

<h5 id="compilación-bzip2">Compilación Bzip2</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">bzip2-1.0.8.tar.gz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nt">-f</span> Makefile-libbz2_so
make clean

make

make <span class="nv">PREFIX</span><span class="o">=</span>/tools <span class="nb">install
cp</span> <span class="nt">-v</span> bzip2-shared /tools/bin/bzip2
<span class="nb">cp</span> <span class="nt">-av</span> libbz2.so<span class="k">*</span> /tools/lib
<span class="nb">ln</span> <span class="nt">-sv</span> libbz2.so.1.0 /tools/lib/libbz2.so
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Bzip2:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348wj.png">
</p>
<p><br></p>

<h5 id="compilación-coreutils">Compilación Coreutils</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">coreutils-8.31.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools <span class="nt">--enable-install-program</span><span class="o">=</span><span class="nb">hostname

</span>make
make <span class="nv">RUN_EXPENSIVE_TESTS</span><span class="o">=</span><span class="nb">yes </span>check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Coreutils:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348xi.png">
</p>
<p><br></p>

<h5 id="compilación-diffutils">Compilación Diffutils</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">diffutils-3.7.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Diffutils:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348xB.png">
</p>
<p><br></p>

<h5 id="compilación-file">Compilación File</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">file-5.38.tar.gz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de File:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348xH.png">
</p>
<p><br></p>

<h5 id="compilación-findutils">Compilación Findutils</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">findutils-4.7.0.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Findutils:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348y1.png">
</p>
<p><br></p>

<p>Bueno, en este punto… como ya hemos avanzado considerablemente, ¡toca hacer otro Snapshot!:</p>

<p align="center">
     <img src="https://funkyimg.com/i/348yu.png">
</p>
<p><br></p>

<h5 id="compilación-gawk">Compilación Gawk</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">gawk-5.0.1.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p><strong>Importante</strong>: Es probable que el <code class="language-plaintext highlighter-rouge">make check</code> devuelva errores, pero no hay de qué preocuparse.</p>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Gawk:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349ii.png">
</p>
<p><br></p>

<h5 id="compilación-gettext">Compilación Gettext</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">gettext-0.20.1.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--disable-shared</span>
make
<span class="nb">cp</span> <span class="nt">-v</span> gettext-tools/src/<span class="o">{</span>msgfmt,msgmerge,xgettext<span class="o">}</span> /tools/bin
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Gettext:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349iX.png">
</p>
<p><br></p>

<h5 id="compilación-grep">Compilación Grep</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">grep-3.4.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Grep:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349jf.png">
</p>
<p><br></p>

<h5 id="compilación-gzip">Compilación Gzip</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">gzip-1.10.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Gzip:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349jy.png">
</p>
<p><br></p>

<h5 id="compilación-make">Compilación Make</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">make-4.3.tar.gz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools <span class="nt">--without-guile</span>

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Make:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349jQ.png">
</p>
<p><br></p>

<h5 id="compilación-patch">Compilación Patch</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">patch-2.7.6.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>En este paquete, a la hora de hacer un <code class="language-plaintext highlighter-rouge">make check</code>, es posible que el campo <strong>XFAIL</strong> devuelve 2 errores, esto es normal y no habrá de qué preocuparse.</p>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Patch:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349k9.png">
</p>
<p><br></p>

<h5 id="compilación-perl">Compilación Perl</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">perl-5.30.1.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sh Configure <span class="nt">-des</span> <span class="nt">-Dprefix</span><span class="o">=</span>/tools <span class="nt">-Dlibs</span><span class="o">=</span><span class="nt">-lm</span> <span class="nt">-Uloclibpth</span> <span class="nt">-Ulocincpth</span>

make
<span class="nb">cp</span> <span class="nt">-v</span> perl cpan/podlators/scripts/pod2man /tools/bin
<span class="nb">mkdir</span> <span class="nt">-pv</span> /tools/lib/perl5/5.30.1
<span class="nb">cp</span> <span class="nt">-Rv</span> lib/<span class="k">*</span> /tools/lib/perl5/5.30.1
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Perl:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349kE.png">
</p>
<p><br></p>

<h5 id="compilación-python">Compilación Python</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">Python-3.8.1.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/def add_multiarch_paths/a \        return'</span> setup.py
./configure <span class="nt">--prefix</span><span class="o">=</span>/tools <span class="nt">--without-ensurepip</span>
make
make <span class="nb">install</span>
</code></pre></div></div>

<p><strong>Anotación</strong>: Si al hacer un <code class="language-plaintext highlighter-rouge">make install</code> en la fase final da un error, lo que habrá que hacer será volver a descomprimir el comprimido de Python y esta vez en el archivo <code class="language-plaintext highlighter-rouge">setup.py</code>, nos iremos nosotros manualmente a la línea que pone <code class="language-plaintext highlighter-rouge">add_multiarch_paths</code>. Una vez situados, justamente debajo de la función, correctamente tabulado pondremos la palabra <code class="language-plaintext highlighter-rouge">return</code>.</p>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Python:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349mg.png">
</p>
<p><br></p>

<h5 id="compilación-sed">Compilación Sed</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">sed-4.8.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Sed:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349mu.png">
</p>
<p><br></p>

<h5 id="compilación-tar">Compilación Tar</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">tar-1.32.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Tar:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349n3.png">
</p>
<p><br></p>

<h5 id="compilación-texinfo">Compilación Texinfo</h5>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">texinfo-6.7.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Texinfo:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349oM.png">
</p>
<p><br></p>

<h5 id="compilación-xz">Compilación Xz</h5>

<p>Madre mía, último paquete a instalar… si señor, buen trabajo. Aún así prepárate, que luego vendrán muchos más.</p>

<p>Para la compilación de este paquete, haremos uso del paquete <code class="language-plaintext highlighter-rouge">xz-5.2.4.tar.xz</code>. Una vez descomprimido, nos meteremos dentro del directorio descomprimido y aplicaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/tools
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, retrocedemos un directorio y borramos el directorio principal de Xz:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349p5.png">
</p>
<p><br></p>

<h4 id="stripping">Stripping</h4>

<p>Este apartado es totalmente opcional, irá destinado a eliminar elementos innecesarios. Pensemos en que los ejecutables y las bibliotecas construidas hasta ahora contienen aproximadamente unos 70 MB de símbolos de depuración innecesarios.</p>

<p>Para eliminar estos símbolos, podemos ejecutar el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strip <span class="nt">--strip-debug</span> /tools/lib/<span class="k">*</span>
/usr/bin/strip <span class="nt">--strip-unneeded</span> /tools/<span class="o">{</span>,s<span class="o">}</span>bin/<span class="k">*</span>
</code></pre></div></div>

<p>Para salvar más espacio, eliminaremos las documentaciones y archivos innecesarios:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-rf</span> /tools/<span class="o">{</span>,share<span class="o">}</span>/<span class="o">{</span>info,man,doc<span class="o">}</span>
find /tools/<span class="o">{</span>lib,libexec<span class="o">}</span> <span class="nt">-name</span> <span class="se">\*</span>.la <span class="nt">-delete</span>
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349pq.png">
</p>
<p><br></p>

<p>En este punto, toca hacer una nueva Snapshot antes de continuar:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349pt.png">
</p>
<p><br></p>

<h4 id="cambio-de-propietario">Cambio de Propietario</h4>

<p>Actualmente, la ruta ‘<em>$LFS/tools</em>’ tiene como propietario asignado al usuario <strong>lfs</strong>, un usuario que existe sólo en el sistema host.</p>

<p>Lo que haremos por el momento será cambiar el propietario y el grupo asignado de forma recursiva al usuario <strong>root</strong>, de la siguiente forma:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chown</span> <span class="nt">-R</span> root:root <span class="nv">$LFS</span>/tools
</code></pre></div></div>

<p><strong>IMPORTANTE</strong>: Esto hay que hacerlo como el usuario <code class="language-plaintext highlighter-rouge">root</code>, por tanto, ejecutamos primero el comando <strong>exit</strong> para salir de la sesión del usuario <code class="language-plaintext highlighter-rouge">lfs</code>.</p>

<h1 id="construyendo-el-sistema-lfs">Construyendo el sistema LFS</h1>

<h4 id="preparando-el-sistema-de-archivos-del-kernel-virtual">Preparando el sistema de archivos del kernel virtual</h4>
<p>Comenzaremos creando los directorios en los que se montarán los sistemas de archivos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-pv</span> <span class="nv">$LFS</span>/<span class="o">{</span>dev,proc,sys,run<span class="o">}</span>
</code></pre></div></div>

<p>Cuando el kernel arranca el sistema, se requiere de la presencia de unos pocos nodos de dispositivo, en particular los dispositivos <code class="language-plaintext highlighter-rouge">console</code> y <code class="language-plaintext highlighter-rouge">nul</code>. Estos nodos del dispositivo deben crearse en el disco duro para que estén disponibles antes de que se inicie <code class="language-plaintext highlighter-rouge">udevd</code> y, además, cuando se inicie Linux <code class="language-plaintext highlighter-rouge">init=/bin/bash</code>.</p>

<p>Podemos crear estos dispositivos ejecutando los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mknod</span> <span class="nt">-m</span> 600 <span class="nv">$LFS</span>/dev/console c 5 1
<span class="nb">mknod</span> <span class="nt">-m</span> 666 <span class="nv">$LFS</span>/dev/null c 1 3
</code></pre></div></div>

<p>Ya en este punto, crearemos un sistema de archivos virtual en el directorio <code class="language-plaintext highlighter-rouge">/dev</code> para permitir que los dispositivos se creen dinámicamente a medida que estos son detectados o accedidos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mount <span class="nt">-v</span> <span class="nt">--bind</span> /dev <span class="nv">$LFS</span>/dev
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349qt.png">
</p>
<p><br></p>

<h4 id="montaje-del-sistema-de-archivos-del-kernel-virtual">Montaje del sistema de archivos del kernel virtual</h4>

<p>En este punto, montaremos los sistemas de archivos del kernel virtual restantes:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mount <span class="nt">-vt</span> devpts devpts <span class="nv">$LFS</span>/dev/pts <span class="nt">-o</span> <span class="nv">gid</span><span class="o">=</span>5,mode<span class="o">=</span>620
mount <span class="nt">-vt</span> proc proc <span class="nv">$LFS</span>/proc
mount <span class="nt">-vt</span> sysfs sysfs <span class="nv">$LFS</span>/sys
mount <span class="nt">-vt</span> tmpfs tmpfs <span class="nv">$LFS</span>/run
</code></pre></div></div>

<p>En algunos sistemas host, <code class="language-plaintext highlighter-rouge">/dev/shm</code> es un enlace simbólico a <code class="language-plaintext highlighter-rouge">/run/shm</code>. El <code class="language-plaintext highlighter-rouge">tmpfs</code> <strong>/run</strong> fue montado arriba, por tanto en este caso… sólo es necesario crear un directorio:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">[</span> <span class="nt">-h</span> <span class="nv">$LFS</span>/dev/shm <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">mkdir</span> <span class="nt">-pv</span> <span class="nv">$LFS</span>/<span class="si">$(</span><span class="nb">readlink</span> <span class="nv">$LFS</span>/dev/shm<span class="si">)</span>
<span class="k">fi</span>
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349qC.png">
</p>
<p><br></p>

<h4 id="entrando-en-el-entorno-chroot">Entrando en el entorno Chroot</h4>

<p>A partir de aquí, ingresaremos al entorno chroot para comenzar a construir e instalar nuestro sistema Linux final.</p>

<p>Como el usuario <strong>root</strong>, ejecutaremos el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chroot</span> <span class="s2">"</span><span class="nv">$LFS</span><span class="s2">"</span> /tools/bin/env <span class="nt">-i</span> <span class="se">\</span>
    <span class="nv">HOME</span><span class="o">=</span>/root                  <span class="se">\</span>
    <span class="nv">TERM</span><span class="o">=</span><span class="s2">"</span><span class="nv">$TERM</span><span class="s2">"</span>                <span class="se">\</span>
    <span class="nv">PS1</span><span class="o">=</span><span class="s1">'(lfs chroot) \u:\w\$ '</span> <span class="se">\</span>
    <span class="nv">PATH</span><span class="o">=</span>/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin <span class="se">\</span>
    /tools/bin/bash <span class="nt">--login</span> +h
</code></pre></div></div>

<p>Una vez ejecutado, deberíamos ver algo como esto:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349qP.png">
</p>
<p><br></p>

<p>Como vemos, en ‘<em>/sources</em>’ deberíamos ver todos nuestros archivos comprimidos que habíamos obtenido del archivo <strong>wget-list</strong>.</p>

<p>Si esto es así, podremos continuar.</p>

<h5 id="creación-de-directorios">Creación de directorios</h5>

<p>Antes de continuar, será necesario crear una estructura base para el sistema de archivos de nuestro sistema Linux. Crearemos un árbol estándar de directorios ejecutando los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-pv</span> /<span class="o">{</span>bin,boot,etc/<span class="o">{</span>opt,sysconfig<span class="o">}</span>,home,lib/firmware,mnt,opt<span class="o">}</span>
<span class="nb">mkdir</span> <span class="nt">-pv</span> /<span class="o">{</span>media/<span class="o">{</span>floppy,cdrom<span class="o">}</span>,sbin,srv,var<span class="o">}</span>
<span class="nb">install</span> <span class="nt">-dv</span> <span class="nt">-m</span> 0750 /root
<span class="nb">install</span> <span class="nt">-dv</span> <span class="nt">-m</span> 1777 /tmp /var/tmp
<span class="nb">mkdir</span> <span class="nt">-pv</span> /usr/<span class="o">{</span>,local/<span class="o">}{</span>bin,include,lib,sbin,src<span class="o">}</span>
<span class="nb">mkdir</span> <span class="nt">-pv</span> /usr/<span class="o">{</span>,local/<span class="o">}</span>share/<span class="o">{</span>color,dict,doc,info,locale,man<span class="o">}</span>
<span class="nb">mkdir</span> <span class="nt">-v</span>  /usr/<span class="o">{</span>,local/<span class="o">}</span>share/<span class="o">{</span>misc,terminfo,zoneinfo<span class="o">}</span>
<span class="nb">mkdir</span> <span class="nt">-v</span>  /usr/libexec
<span class="nb">mkdir</span> <span class="nt">-pv</span> /usr/<span class="o">{</span>,local/<span class="o">}</span>share/man/man<span class="o">{</span>1..8<span class="o">}</span>
<span class="nb">mkdir</span> <span class="nt">-v</span>  /usr/lib/pkgconfig

<span class="k">case</span> <span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span> <span class="k">in
 </span>x86_64<span class="p">)</span> <span class="nb">mkdir</span> <span class="nt">-v</span> /lib64 <span class="p">;;</span>
<span class="k">esac</span>

<span class="nb">mkdir</span> <span class="nt">-v</span> /var/<span class="o">{</span>log,mail,spool<span class="o">}</span>
<span class="nb">ln</span> <span class="nt">-sv</span> /run /var/run
<span class="nb">ln</span> <span class="nt">-sv</span> /run/lock /var/lock
<span class="nb">mkdir</span> <span class="nt">-pv</span> /var/<span class="o">{</span>opt,cache,lib/<span class="o">{</span>color,misc,locate<span class="o">}</span>,local<span class="o">}</span>
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349rN.png">
</p>
<p><br></p>

<h5 id="creación-de-archivos-esenciales-y-links-simbólicos">Creación de archivos esenciales y Links Simbólicos</h5>

<p>Algunos programas usan rutas “cableadas” a programas que aún no existen. Para satisfacer la accesibilidad de estos programas, crearemos una serie de enlaces simbólicos los cuales serán reemplazados por archivos reales:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-sv</span> /tools/bin/<span class="o">{</span>bash,cat,chmod,dd,echo,ln,mkdir,pwd,rm,stty,touch<span class="o">}</span> /bin
<span class="nb">ln</span> <span class="nt">-sv</span> /tools/bin/<span class="o">{</span><span class="nb">env</span>,install,perl,printf<span class="o">}</span>         /usr/bin
<span class="nb">ln</span> <span class="nt">-sv</span> /tools/lib/libgcc_s.so<span class="o">{</span>,.1<span class="o">}</span>                  /usr/lib
<span class="nb">ln</span> <span class="nt">-sv</span> /tools/lib/libstdc++.<span class="o">{</span>a,so<span class="o">{</span>,.6<span class="o">}}</span>             /usr/lib
<span class="nb">ln</span> <span class="nt">-sv</span> bash /bin/sh
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349rQ.png">
</p>
<p><br></p>

<p>Una vez hecho, para satisfacer las utilidades que esperan la presencia de <code class="language-plaintext highlighter-rouge">/etc/mtab</code>, crearemos otro enlace simbólico:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-sv</span> /proc/self/mounts /etc/mtab
</code></pre></div></div>

<p>Para que el usuario <strong>root</strong> pueda iniciar sesión y para que se reconozca el nombre <strong>root</strong>, deben de haber entradas relevantes en los archivos ‘<em>/etc/passwd</em>’ y ‘<em>/etc/group</em>’.</p>

<p>Crearemos estos archivos de la siguiente forma:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/passwd &lt;&lt; <span class="s2">"EOF"</span>
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/dev/null:/bin/false
daemon:x:6:6:Daemon User:/dev/null:/bin/false
messagebus:x:18:18:D-Bus Message Daemon User:/var/run/dbus:/bin/false
nobody:x:99:99:Unprivileged User:/dev/null:/bin/false
EOF

<span class="nb">cat</span> <span class="o">&gt;</span> /etc/group &lt;&lt; <span class="s2">"EOF"</span>
root:x:0:
bin:x:1:daemon
sys:x:2:
kmem:x:3:
tape:x:4:
<span class="nb">tty</span>:x:5:
daemon:x:6:
floppy:x:7:
disk:x:8:
lp:x:9:
dialout:x:10:
audio:x:11:
video:x:12:
utmp:x:13:
usb:x:14:
cdrom:x:15:
adm:x:16:
messagebus:x:18:
input:x:24:
mail:x:34:
kvm:x:61:
wheel:x:97:
nogroup:x:99:
<span class="nb">users</span>:x:999:
EOF
</code></pre></div></div>

<p>Por último, para eliminar la cadena <strong>I have no name!</strong>, iniciaremos una nueva shell:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec</span> /tools/bin/bash <span class="nt">--login</span> +h
</code></pre></div></div>

<p>Todo este proceso, debería verse de la siguiente forma:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349rP.png">
</p>
<p><br></p>

<p>Al final de la imagen, lo que he hecho ha sido inicializar los archivos de registro y asignarles los permisos adecuados, serían estos comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">touch</span> /var/log/<span class="o">{</span>btmp,lastlog,faillog,wtmp<span class="o">}</span>
<span class="nb">chgrp</span> <span class="nt">-v</span> utmp /var/log/lastlog
<span class="nb">chmod</span> <span class="nt">-v</span> 664  /var/log/lastlog
<span class="nb">chmod</span> <span class="nt">-v</span> 600  /var/log/btmp
</code></pre></div></div>

<h4 id="instalación-del-software-básico-del-sistema">Instalación del Software básico del sistema</h4>

<p>Comienza una nueva labor de compilación, esta vez en el entorno chroot. Si la anterior nos pareció larga… en esta sí que habrá que armarse de paciencia, porque será el triple de larga.</p>

<p>Os iré definiendo por cada paquete los comandos que tendréis que ir ejecutando a nivel de sistema. La compilación de estos paquetes si seguís paso a paso los comandos no os deberían de dar error (salvo algún que otro <code class="language-plaintext highlighter-rouge">make check</code>, pero por lo demás las instalaciones se deberían realizar correctamente).</p>

<p>Antes de proseguir, deberemos situarnos en el directorio <code class="language-plaintext highlighter-rouge">/sources</code>, que es donde se sitúan todos los comprimidos.</p>

<h5 id="api-headers-en-lfs">API Headers en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make mrproper

make headers
find usr/include <span class="nt">-name</span> <span class="s1">'.*'</span> <span class="nt">-delete</span>
<span class="nb">rm </span>usr/include/Makefile
<span class="nb">cp</span> <span class="nt">-rv</span> usr/include/<span class="k">*</span> /usr/include
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="man-pages-en-lfs">Man pages en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="glibc-en-lfs">Glibc en LFS</h5>

<p><strong>AVISO:</strong> La compilación e instalación de este paquete puede demorar bastante tiempo, así que tendréis que salir un poco a tomar el aire. Asimismo, la fase del <code class="language-plaintext highlighter-rouge">make check</code> es normal que de algún que otro fallo, pero no hay de qué preocuparse.</p>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>patch <span class="nt">-Np1</span> <span class="nt">-i</span> ../glibc-2.31-fhs-1.patch

<span class="k">case</span> <span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span> <span class="k">in
    </span>i?86<span class="p">)</span>   <span class="nb">ln</span> <span class="nt">-sfv</span> ld-linux.so.2 /lib/ld-lsb.so.3
    <span class="p">;;</span>
    x86_64<span class="p">)</span> <span class="nb">ln</span> <span class="nt">-sfv</span> ../lib/ld-linux-x86-64.so.2 /lib64
            <span class="nb">ln</span> <span class="nt">-sfv</span> ../lib/ld-linux-x86-64.so.2 /lib64/ld-lsb-x86-64.so.3
    <span class="p">;;</span>
<span class="k">esac</span>

<span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd       </span>build

<span class="nv">CC</span><span class="o">=</span><span class="s2">"gcc -ffile-prefix-map=/tools=/usr"</span> <span class="se">\</span>
../configure <span class="nt">--prefix</span><span class="o">=</span>/usr                          <span class="se">\</span>
             <span class="nt">--disable-werror</span>                       <span class="se">\</span>
             <span class="nt">--enable-kernel</span><span class="o">=</span>3.2                    <span class="se">\</span>
             <span class="nt">--enable-stack-protector</span><span class="o">=</span>strong        <span class="se">\</span>
             <span class="nt">--with-headers</span><span class="o">=</span>/usr/include            <span class="se">\</span>
             <span class="nv">libc_cv_slibdir</span><span class="o">=</span>/lib

make

<span class="k">case</span> <span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span> <span class="k">in
  </span>i?86<span class="p">)</span>   <span class="nb">ln</span> <span class="nt">-sfnv</span> <span class="nv">$PWD</span>/elf/ld-linux.so.2        /lib <span class="p">;;</span>
  x86_64<span class="p">)</span> <span class="nb">ln</span> <span class="nt">-sfnv</span> <span class="nv">$PWD</span>/elf/ld-linux-x86-64.so.2 /lib <span class="p">;;</span>
<span class="k">esac</span>

make check

<span class="nb">touch</span> /etc/ld.so.conf
<span class="nb">sed</span> <span class="s1">'/test-installation/s@$(PERL)@echo not running@'</span> <span class="nt">-i</span> ../Makefile
make <span class="nb">install
cp</span> <span class="nt">-v</span> ../nscd/nscd.conf /etc/nscd.conf
<span class="nb">mkdir</span> <span class="nt">-pv</span> /var/cache/nscd
</code></pre></div></div>

<p>Deberíais poder llegar hasta aquí sin problemas:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349xv.png">
</p>
<p><br></p>

<p>Ahora bien, toca instalar las configuraciones regionales. Ejecutaremos estos comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-pv</span> /usr/lib/locale
localedef <span class="nt">-i</span> POSIX <span class="nt">-f</span> UTF-8 C.UTF-8 2&gt; /dev/null <span class="o">||</span> <span class="nb">true
</span>localedef <span class="nt">-i</span> cs_CZ <span class="nt">-f</span> UTF-8 cs_CZ.UTF-8
localedef <span class="nt">-i</span> de_DE <span class="nt">-f</span> ISO-8859-1 de_DE
localedef <span class="nt">-i</span> de_DE@euro <span class="nt">-f</span> ISO-8859-15 de_DE@euro
localedef <span class="nt">-i</span> de_DE <span class="nt">-f</span> UTF-8 de_DE.UTF-8
localedef <span class="nt">-i</span> el_GR <span class="nt">-f</span> ISO-8859-7 el_GR
localedef <span class="nt">-i</span> en_GB <span class="nt">-f</span> UTF-8 en_GB.UTF-8
localedef <span class="nt">-i</span> en_HK <span class="nt">-f</span> ISO-8859-1 en_HK
localedef <span class="nt">-i</span> en_PH <span class="nt">-f</span> ISO-8859-1 en_PH
localedef <span class="nt">-i</span> en_US <span class="nt">-f</span> ISO-8859-1 en_US
localedef <span class="nt">-i</span> en_US <span class="nt">-f</span> UTF-8 en_US.UTF-8
localedef <span class="nt">-i</span> es_MX <span class="nt">-f</span> ISO-8859-1 es_MX
localedef <span class="nt">-i</span> fa_IR <span class="nt">-f</span> UTF-8 fa_IR
localedef <span class="nt">-i</span> fr_FR <span class="nt">-f</span> ISO-8859-1 fr_FR
localedef <span class="nt">-i</span> fr_FR@euro <span class="nt">-f</span> ISO-8859-15 fr_FR@euro
localedef <span class="nt">-i</span> fr_FR <span class="nt">-f</span> UTF-8 fr_FR.UTF-8
localedef <span class="nt">-i</span> it_IT <span class="nt">-f</span> ISO-8859-1 it_IT
localedef <span class="nt">-i</span> it_IT <span class="nt">-f</span> UTF-8 it_IT.UTF-8
localedef <span class="nt">-i</span> ja_JP <span class="nt">-f</span> EUC-JP ja_JP
localedef <span class="nt">-i</span> ja_JP <span class="nt">-f</span> SHIFT_JIS ja_JP.SIJS 2&gt; /dev/null <span class="o">||</span> <span class="nb">true
</span>localedef <span class="nt">-i</span> ja_JP <span class="nt">-f</span> UTF-8 ja_JP.UTF-8
localedef <span class="nt">-i</span> ru_RU <span class="nt">-f</span> KOI8-R ru_RU.KOI8-R
localedef <span class="nt">-i</span> ru_RU <span class="nt">-f</span> UTF-8 ru_RU.UTF-8
localedef <span class="nt">-i</span> tr_TR <span class="nt">-f</span> UTF-8 tr_TR.UTF-8
localedef <span class="nt">-i</span> zh_CN <span class="nt">-f</span> GB18030 zh_CN.GB18030
localedef <span class="nt">-i</span> zh_HK <span class="nt">-f</span> BIG5-HKSCS zh_HK.BIG5-HKSCS
</code></pre></div></div>

<p>Y por último, este otro comando, el cual puede llevar bastante tiempo:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make localedata/install-locales
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349xN.png">
</p>
<p><br></p>

<p>Una vez hecho, crearemos un nuevo archivo ‘<em>/etc/nsswitch.conf</em>’ aplicando el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/nsswitch.conf &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/nsswitch.conf</span>

passwd: files
group: files
shadow: files

hosts: files dns
networks: files

protocols: files
services: files
ethers: files
rpc: files

<span class="c"># End /etc/nsswitch.conf</span>
EOF
</code></pre></div></div>

<p>Este archivo es necesario dado que los valores predeterminados <strong>Glibc</strong> no funcionan correctamente en un entorno de red.</p>

<p>Añadiremos los datos relacionados con la zona horaria ejecutando los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar</span> <span class="nt">-xf</span> ../../tzdata2019c.tar.gz

<span class="nv">ZONEINFO</span><span class="o">=</span>/usr/share/zoneinfo
<span class="nb">mkdir</span> <span class="nt">-pv</span> <span class="nv">$ZONEINFO</span>/<span class="o">{</span>posix,right<span class="o">}</span>

<span class="k">for </span>tz <span class="k">in </span>etcetera southamerica northamerica europe africa antarctica  <span class="se">\</span>
          asia australasia backward pacificnew systemv<span class="p">;</span> <span class="k">do
    </span>zic <span class="nt">-L</span> /dev/null   <span class="nt">-d</span> <span class="nv">$ZONEINFO</span>       <span class="k">${</span><span class="nv">tz</span><span class="k">}</span>
    zic <span class="nt">-L</span> /dev/null   <span class="nt">-d</span> <span class="nv">$ZONEINFO</span>/posix <span class="k">${</span><span class="nv">tz</span><span class="k">}</span>
    zic <span class="nt">-L</span> leapseconds <span class="nt">-d</span> <span class="nv">$ZONEINFO</span>/right <span class="k">${</span><span class="nv">tz</span><span class="k">}</span>
<span class="k">done

</span><span class="nb">cp</span> <span class="nt">-v</span> zone.tab zone1970.tab iso3166.tab <span class="nv">$ZONEINFO</span>
zic <span class="nt">-d</span> <span class="nv">$ZONEINFO</span> <span class="nt">-p</span> America/New_York
<span class="nb">unset </span>ZONEINFO
</code></pre></div></div>

<p>Ya en este punto, ejecutaremos el siguiente comando:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tzselect
</code></pre></div></div>

<p>En mi caso estoy en Canarias, por tanto seleccionaré las siguientes opciones:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349zC.png">
</p>
<p><br></p>

<p>Una vez seleccionadas estas opciones, crearemos el siguiente enlace simbólico con el nombre de la zona horaria previamente seleccionada:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-sfv</span> /usr/share/zoneinfo/&lt;xxx&gt; /etc/localtime
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349zH.png">
</p>
<p><br></p>

<p>Por último, configuraremos el cargador dinámico:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/ld.so.conf &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/ld.so.conf</span>
/usr/local/lib
/opt/lib

EOF

<span class="nb">cat</span> <span class="o">&gt;&gt;</span> /etc/ld.so.conf &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Add an include directory</span>
include /etc/ld.so.conf.d/<span class="k">*</span>.conf

EOF
<span class="nb">mkdir</span> <span class="nt">-pv</span> /etc/ld.so.conf.d
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349zW.png">
</p>
<p><br></p>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="ajuste-de-la-toolchain">Ajuste de la Toolchain</h5>

<p>Ahora que se han instalado las bibliotecas de C finales, es hora de ajustar la cadena de herramientas para que se vincule cualquier programa recién compilado con estas bibliotecas nuevas.</p>

<p>Ejecutamos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mv</span> <span class="nt">-v</span> /tools/bin/<span class="o">{</span>ld,ld-old<span class="o">}</span>
<span class="nb">mv</span> <span class="nt">-v</span> /tools/<span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span><span class="nt">-pc-linux-gnu</span>/bin/<span class="o">{</span>ld,ld-old<span class="o">}</span>
<span class="nb">mv</span> <span class="nt">-v</span> /tools/bin/<span class="o">{</span>ld-new,ld<span class="o">}</span>
<span class="nb">ln</span> <span class="nt">-sv</span> /tools/bin/ld /tools/<span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span><span class="nt">-pc-linux-gnu</span>/bin/ld

gcc <span class="nt">-dumpspecs</span> | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s@/tools@@g'</span>                   <span class="se">\</span>
    <span class="nt">-e</span> <span class="s1">'/\*startfile_prefix_spec:/{n;s@.*@/usr/lib/ @}'</span> <span class="se">\</span>
    <span class="nt">-e</span> <span class="s1">'/\*cpp:/{n;s@$@ -isystem /usr/include@}'</span> <span class="o">&gt;</span>      <span class="se">\</span>
    <span class="sb">`</span><span class="nb">dirname</span> <span class="si">$(</span>gcc <span class="nt">--print-libgcc-file-name</span><span class="si">)</span><span class="sb">`</span>/specs

<span class="nb">echo</span> <span class="s1">'int main(){}'</span> <span class="o">&gt;</span> dummy.c
cc dummy.c <span class="nt">-v</span> <span class="nt">-Wl</span>,--verbose &amp;&gt; dummy.log
readelf <span class="nt">-l</span> a.out | <span class="nb">grep</span> <span class="s1">': /lib'</span>
</code></pre></div></div>

<p>Si una vez aplicados estos comandos nos sale el siguiente output, es que todo está correcto:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349Ae.png">
</p>
<p><br></p>

<p>Ahora bien, ¿quieres quedarte tranquilo y saber si todo se ha hecho correctamente?, hagamos las siguientes comprobaciones.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep</span> <span class="nt">-o</span> <span class="s1">'/usr/lib.*/crt[1in].*succeeded'</span> dummy.log
<span class="nb">grep</span> <span class="nt">-B1</span> <span class="s1">'^ /usr/include'</span> dummy.log
<span class="nb">grep</span> <span class="s1">'SEARCH.*/usr/lib'</span> dummy.log |sed <span class="s1">'s|; |\n|g'</span>
<span class="nb">grep</span> <span class="s2">"/lib.*/libc.so.6 "</span> dummy.log
<span class="nb">grep </span>found dummy.log
</code></pre></div></div>

<p>Si la ejecución de cada uno de estos comandos nos devuelve los siguientes resultados, es que todo está correcto:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349Ev.png">
</p>
<p><br></p>

<p>El último comando ejecutado, es para limpiar los archivos de prueba:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-v</span> dummy.c a.out dummy.log
</code></pre></div></div>

<p>Como esta fase ha llevado su tiempo, lo mejor es hacer otra Snapshot:</p>

<p align="center">
     <img src="https://funkyimg.com/i/349EP.png">
</p>
<p><br></p>

<h5 id="zlib-en-lfs">Zlib en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/lib/libz.so.<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libz.so<span class="si">)</span> /usr/lib/libz.so
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="bzip2-en-lfs">Bzip2 en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>patch <span class="nt">-Np1</span> <span class="nt">-i</span> ../bzip2-1.0.8-install_docs-1.patch
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s@\(ln -s -f \)$(PREFIX)/bin/@\1@'</span> Makefile
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s@(PREFIX)/man@(PREFIX)/share/man@g"</span> Makefile
make <span class="nt">-f</span> Makefile-libbz2_so
make clean

make
make <span class="nv">PREFIX</span><span class="o">=</span>/usr <span class="nb">install

cp</span> <span class="nt">-v</span> bzip2-shared /bin/bzip2
<span class="nb">cp</span> <span class="nt">-av</span> libbz2.so<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-sv</span> ../../lib/libbz2.so.1.0 /usr/lib/libbz2.so
<span class="nb">rm</span> <span class="nt">-v</span> /usr/bin/<span class="o">{</span>bunzip2,bzcat,bzip2<span class="o">}</span>
<span class="nb">ln</span> <span class="nt">-sv</span> bzip2 /bin/bunzip2
<span class="nb">ln</span> <span class="nt">-sv</span> bzip2 /bin/bzcat
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="xz-en-lfs">Xz en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr    <span class="se">\</span>
            <span class="nt">--disable-static</span> <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/xz-5.2.4

make
make check

make <span class="nb">install
mv</span> <span class="nt">-v</span>   /usr/bin/<span class="o">{</span>lzma,unlzma,lzcat,xz,unxz,xzcat<span class="o">}</span> /bin
<span class="nb">mv</span> <span class="nt">-v</span> /usr/lib/liblzma.so.<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-svf</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/liblzma.so<span class="si">)</span> /usr/lib/liblzma.so
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="file-en-lfs">File en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="readline-en-lfs">Readline en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/MV.*old/d'</span> Makefile.in
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/{OLDSUFF}/c:'</span> support/shlib-install

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr    <span class="se">\</span>
            <span class="nt">--disable-static</span> <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/readline-8.0

make <span class="nv">SHLIB_LIBS</span><span class="o">=</span><span class="s2">"-L/tools/lib -lncursesw"</span>
make <span class="nv">SHLIB_LIBS</span><span class="o">=</span><span class="s2">"-L/tools/lib -lncursesw"</span> <span class="nb">install
mv</span> <span class="nt">-v</span> /usr/lib/lib<span class="o">{</span>readline,history<span class="o">}</span>.so.<span class="k">*</span> /lib
<span class="nb">chmod</span> <span class="nt">-v</span> u+w /lib/lib<span class="o">{</span>readline,history<span class="o">}</span>.so.<span class="k">*</span>
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libreadline.so<span class="si">)</span> /usr/lib/libreadline.so
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libhistory.so <span class="si">)</span> /usr/lib/libhistory.so

<span class="nb">install</span> <span class="nt">-v</span> <span class="nt">-m644</span> doc/<span class="k">*</span>.<span class="o">{</span>ps,pdf,html,dvi<span class="o">}</span> /usr/share/doc/readline-8.0
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="m4-en-lfs">M4 en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/IO_ftrylockfile/IO_EOF_SEEN/'</span> lib/<span class="k">*</span>.c
<span class="nb">echo</span> <span class="s2">"#define _IO_IN_BACKUP 0x100"</span> <span class="o">&gt;&gt;</span> lib/stdio-impl.h

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr
make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="bc-en-lfs">Bc en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PREFIX</span><span class="o">=</span>/usr <span class="nv">CC</span><span class="o">=</span>gcc <span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">"-std=c99"</span> ./configure.sh <span class="nt">-G</span> <span class="nt">-O3</span>

make
make <span class="nb">test
</span>make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="binutils-en-lfs">Binutils en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, comenzaremos haciendo una pequeña verificación con el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>expect <span class="nt">-c</span> <span class="s2">"spawn ls"</span>
</code></pre></div></div>

<p>Si la ejecución de este comando devuelve el siguiente output:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spawn <span class="nb">ls</span>
</code></pre></div></div>

<p>Entonces podemos quedarnos tranquilos.</p>

<p>Posteriormente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/@\tincremental_copy/d'</span> gold/testsuite/Makefile.in
make <span class="nt">-v</span> build
<span class="nb">cd </span>build

../configure <span class="nt">--prefix</span><span class="o">=</span>/usr       <span class="se">\</span>
             <span class="nt">--enable-gold</span>       <span class="se">\</span>
             <span class="nt">--enable-ld</span><span class="o">=</span>default <span class="se">\</span>
             <span class="nt">--enable-plugins</span>    <span class="se">\</span>
             <span class="nt">--enable-shared</span>     <span class="se">\</span>
             <span class="nt">--disable-werror</span>    <span class="se">\</span>
             <span class="nt">--enable-64-bit-bfd</span> <span class="se">\</span>
             <span class="nt">--with-system-zlib</span>

make <span class="nv">tooldir</span><span class="o">=</span>/usr
make <span class="nt">-k</span> check
make <span class="nv">tooldir</span><span class="o">=</span>/usr <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="gmp-en-lfs">GMP en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr    <span class="se">\</span>
            <span class="nt">--enable-cxx</span>     <span class="se">\</span>
            <span class="nt">--disable-static</span> <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/gmp-6.2.0

make
make html
make check 2&gt;&amp;1 | <span class="nb">tee </span>gmp-check-log
<span class="nb">awk</span> <span class="s1">'/# PASS:/{total+=$3} ; END{print total}'</span> gmp-check-log <span class="c"># Verificamos que la ejecución de este comando devuelva un número mayor a 190</span>
make <span class="nb">install
</span>make install-html
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="mpfr-en-lfs">MPFR en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr        <span class="se">\</span>
            <span class="nt">--disable-static</span>     <span class="se">\</span>
            <span class="nt">--enable-thread-safe</span> <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/mpfr-4.0.2

make
make html
make check
make <span class="nb">install
</span>make install-html
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="mpc-en-lfs">MPC en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr    <span class="se">\</span>
            <span class="nt">--disable-static</span> <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/mpc-1.1.0

make
make html
make check
make <span class="nb">install
</span>make install-html
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="attr-en-lfs">Attr en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr     <span class="se">\</span>
            <span class="nt">--bindir</span><span class="o">=</span>/bin     <span class="se">\</span>
            <span class="nt">--disable-static</span>  <span class="se">\</span>
            <span class="nt">--sysconfdir</span><span class="o">=</span>/etc <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/attr-2.4.48

make
make check
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/lib/libattr.so.<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libattr.so<span class="si">)</span> /usr/lib/libattr.so
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="acl-en-lfs">Acl en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr         <span class="se">\</span>
            <span class="nt">--bindir</span><span class="o">=</span>/bin         <span class="se">\</span>
            <span class="nt">--disable-static</span>      <span class="se">\</span>
            <span class="nt">--libexecdir</span><span class="o">=</span>/usr/lib <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/acl-2.2.53

make
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/lib/libacl.so.<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libacl.so<span class="si">)</span> /usr/lib/libacl.so
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="instalación-del-shadow">Instalación del Shadow</h5>

<p>Para configurar el <strong>Shadow</strong> en nuestro sistema Linux, comenzaremos descomprimiendo el comprimido correspondiente. Posteriormente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/groups$(EXEEXT) //'</span> src/Makefile.in
find man <span class="nt">-name</span> Makefile.in <span class="nt">-exec</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/groups\.1 / /'</span>   <span class="o">{}</span> <span class="se">\;</span>
find man <span class="nt">-name</span> Makefile.in <span class="nt">-exec</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/getspnam\.3 / /'</span> <span class="o">{}</span> <span class="se">\;</span>
find man <span class="nt">-name</span> Makefile.in <span class="nt">-exec</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/passwd\.5 / /'</span>   <span class="o">{}</span> <span class="se">\;</span>

<span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-e</span> <span class="s1">'s@#ENCRYPT_METHOD DES@ENCRYPT_METHOD SHA512@'</span> <span class="se">\</span>
       <span class="nt">-e</span> <span class="s1">'s@/var/spool/mail@/var/mail@'</span> etc/login.defs

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s@DICTPATH.*@DICTPATH\t/lib/cracklib/pw_dict@'</span> etc/login.defs
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/1000/999/'</span> etc/useradd
./configure <span class="nt">--sysconfdir</span><span class="o">=</span>/etc <span class="nt">--with-group-name-max-length</span><span class="o">=</span>32

make
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez hecho, configuramos el shadow habilitando las <code class="language-plaintext highlighter-rouge">shadowed passwords</code> y las <code class="language-plaintext highlighter-rouge">shadowed group passwords</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwconv
grpconv
</code></pre></div></div>

<p>Por último, asignaremos una contraseña al usuario root:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>passwd root
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/349QH.png">
</p>
<p><br></p>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="gcc-en-lfs">GCC en LFS</h5>

<p><strong>AVISO</strong>: La instalación de este paquete puede demorar MUCHO tiempo, así que paciencia.</p>

<p>Comenzaremos descomprimiendo el comprimido correspondiente. Una vez hecho, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">case</span> <span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span> <span class="k">in
  </span>x86_64<span class="p">)</span>
    <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'/m64=/s/lib64/lib/'</span> <span class="se">\</span>
        <span class="nt">-i</span>.orig gcc/config/i386/t-linux64
  <span class="p">;;</span>
<span class="k">esac</span>

<span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'1161 s|^|//|'</span> <span class="se">\</span>
    <span class="nt">-i</span> libsanitizer/sanitizer_common/sanitizer_platform_limits_posix.cc

<span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd </span>build

<span class="nv">SED</span><span class="o">=</span><span class="nb">sed</span>                               <span class="se">\</span>
../configure <span class="nt">--prefix</span><span class="o">=</span>/usr            <span class="se">\</span>
             <span class="nt">--enable-languages</span><span class="o">=</span>c,c++ <span class="se">\</span>
             <span class="nt">--disable-multilib</span>       <span class="se">\</span>
             <span class="nt">--disable-bootstrap</span>      <span class="se">\</span>
             <span class="nt">--with-system-zlib</span>

make

<span class="nb">ulimit</span> <span class="nt">-s</span> 32768

<span class="nb">chown</span> <span class="nt">-Rv</span> nobody <span class="nb">.</span> 
su nobody <span class="nt">-s</span> /bin/bash <span class="nt">-c</span> <span class="s2">"PATH=</span><span class="nv">$PATH</span><span class="s2"> make -k check"</span> <span class="c"># Es normal que puedan salir errores en la ejecución de este comando, no hay de qué preocuparse.</span>

../contrib/test_summary
</code></pre></div></div>

<p>Una vez hecho, proseguiremos con la instalación:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nb">install
rm</span> <span class="nt">-rf</span> /usr/lib/gcc/<span class="si">$(</span>gcc <span class="nt">-dumpmachine</span><span class="si">)</span>/9.2.0/include-fixed/bits/

<span class="nb">chown</span> <span class="nt">-v</span> <span class="nt">-R</span> root:root <span class="se">\</span>
    /usr/lib/gcc/<span class="k">*</span>linux-gnu/9.2.0/include<span class="o">{</span>,-fixed<span class="o">}</span>

<span class="nb">ln</span> <span class="nt">-sv</span> ../usr/bin/cpp /lib

<span class="nb">ln</span> <span class="nt">-sv</span> gcc /usr/bin/cc

<span class="nb">install</span> <span class="nt">-v</span> <span class="nt">-dm755</span> /usr/lib/bfd-plugins
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../libexec/gcc/<span class="si">$(</span>gcc <span class="nt">-dumpmachine</span><span class="si">)</span>/9.2.0/liblto_plugin.so <span class="se">\</span>
        /usr/lib/bfd-plugins/
</code></pre></div></div>

<p>¿Hay alguna forma en este punto de saber si la instalación se ha realizado con éxito?, efectivamente, tenemos una forma.</p>

<p>La idea será ejecutar los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'int main(){}'</span> <span class="o">&gt;</span> dummy.c
cc dummy.c <span class="nt">-v</span> <span class="nt">-Wl</span>,--verbose &amp;&gt; dummy.log
readelf <span class="nt">-l</span> a.out | <span class="nb">grep</span> <span class="s1">': /lib'</span>

<span class="nb">grep</span> <span class="nt">-o</span> <span class="s1">'/usr/lib.*/crt[1in].*succeeded'</span> dummy.log

<span class="nb">grep</span> <span class="nt">-B4</span> <span class="s1">'^ /usr/include'</span> dummy.log

<span class="nb">grep</span> <span class="s1">'SEARCH.*/usr/lib'</span> dummy.log |sed <span class="s1">'s|; |\n|g'</span>

<span class="nb">grep</span> <span class="s2">"/lib.*/libc.so.6 "</span> dummy.log

<span class="nb">grep </span>found dummy.log

<span class="nb">rm</span> <span class="nt">-v</span> dummy.c a.out dummy.log

<span class="nb">mkdir</span> <span class="nt">-pv</span> /usr/share/gdb/auto-load/usr/lib
<span class="nb">mv</span> <span class="nt">-v</span> /usr/lib/<span class="k">*</span>gdb.py /usr/share/gdb/auto-load/usr/lib
</code></pre></div></div>

<p>Para saber si todo está en orden, deberás comparar el output con lo siguiente que me sale a mi:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34ap1.png">
</p>
<p><br></p>

<p>Si los outputs te coinciden por la ejecución de cada comando aislado, entonces está todo correcto y podrás continuar.</p>

<p>Como esta fase ha llevado mucho tiempo, lo suyo será hacer otra Snapshot:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34ape.png">
</p>
<p><br></p>

<p>¡No te olvides de retroceder los directorios correspondientes y borrar el directorio principal del archivo descomprimido!</p>

<h5 id="pk-config-en-lfs">Pk config en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr              <span class="se">\</span>
            <span class="nt">--with-internal-glib</span>       <span class="se">\</span>
            <span class="nt">--disable-host-tool</span>        <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/pkg-config-0.29.2

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="ncurses-en-lfs">Ncurses en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/LIBTOOL_INSTALL/d'</span> c++/Makefile.in

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr           <span class="se">\</span>
            <span class="nt">--mandir</span><span class="o">=</span>/usr/share/man <span class="se">\</span>
            <span class="nt">--with-shared</span>           <span class="se">\</span>
            <span class="nt">--without-debug</span>         <span class="se">\</span>
            <span class="nt">--without-normal</span>        <span class="se">\</span>
            <span class="nt">--enable-pc-files</span>       <span class="se">\</span>
            <span class="nt">--enable-widec</span>

make
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/lib/libncursesw.so.6<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libncursesw.so<span class="si">)</span> /usr/lib/libncursesw.so

<span class="k">for </span>lib <span class="k">in </span>ncurses form panel menu <span class="p">;</span> <span class="k">do
    </span><span class="nb">rm</span> <span class="nt">-vf</span>                    /usr/lib/lib<span class="k">${</span><span class="nv">lib</span><span class="k">}</span>.so
    <span class="nb">echo</span> <span class="s2">"INPUT(-l</span><span class="k">${</span><span class="nv">lib</span><span class="k">}</span><span class="s2">w)"</span> <span class="o">&gt;</span> /usr/lib/lib<span class="k">${</span><span class="nv">lib</span><span class="k">}</span>.so
    <span class="nb">ln</span> <span class="nt">-sfv</span> <span class="k">${</span><span class="nv">lib</span><span class="k">}</span>w.pc        /usr/lib/pkgconfig/<span class="k">${</span><span class="nv">lib</span><span class="k">}</span>.pc
<span class="k">done

</span><span class="nb">rm</span> <span class="nt">-vf</span>                     /usr/lib/libcursesw.so
<span class="nb">echo</span> <span class="s2">"INPUT(-lncursesw)"</span> <span class="o">&gt;</span> /usr/lib/libcursesw.so
<span class="nb">ln</span> <span class="nt">-sfv</span> libncurses.so      /usr/lib/libcurses.so

<span class="nb">mkdir</span> <span class="nt">-v</span>       /usr/share/doc/ncurses-6.2
<span class="nb">cp</span> <span class="nt">-v</span> <span class="nt">-R</span> doc/<span class="k">*</span> /usr/share/doc/ncurses-6.2
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="libcap-en-lfs">Libcap en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/install.*STA...LIBNAME/d'</span> libcap/Makefile
make <span class="nv">lib</span><span class="o">=</span>lib
make <span class="nb">test
</span>make <span class="nv">lib</span><span class="o">=</span>lib <span class="nb">install
chmod</span> <span class="nt">-v</span> 755 /lib/libcap.so.2.31
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="sed-en-lfs">Sed en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/usr/tools/'</span>                 build-aux/help2man
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/testsuite.panic-tests.sh//'</span> Makefile.in

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--bindir</span><span class="o">=</span>/bin

make
make html
make check

make <span class="nb">install
install</span> <span class="nt">-d</span> <span class="nt">-m755</span>           /usr/share/doc/sed-4.8
<span class="nb">install</span> <span class="nt">-m644</span> doc/sed.html /usr/share/doc/sed-4.8
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="psmisc-en-lfs">Psmisc en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/bin/fuser   /bin
<span class="nb">mv</span> <span class="nt">-v</span> /usr/bin/killall /bin
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="iana-etc-en-lfs">Iana Etc en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="bison-en-lfs">Bison en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/bison-3.5.2
make
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="flex-en-lfs">Flex en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"/math.h/a #include &lt;malloc.h&gt;"</span> src/flexdef.h

<span class="nv">HELP2MAN</span><span class="o">=</span>/tools/bin/true <span class="se">\</span>
./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/flex-2.6.4

make
make check
make <span class="nb">install

ln</span> <span class="nt">-sv</span> flex /usr/bin/lex
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="grep-en-lfs">Grep en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--bindir</span><span class="o">=</span>/bin

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="bash-en-lfs">Bash en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>patch <span class="nt">-Np1</span> <span class="nt">-i</span> ../bash-5.0-upstream_fixes-1.patch

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr                    <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/bash-5.0 <span class="se">\</span>
            <span class="nt">--without-bash-malloc</span>            <span class="se">\</span>
            <span class="nt">--with-installed-readline</span>

make
<span class="nb">chown</span> <span class="nt">-Rv</span> nobody <span class="nb">.</span>
su nobody <span class="nt">-s</span> /bin/bash <span class="nt">-c</span> <span class="s2">"PATH=</span><span class="nv">$PATH</span><span class="s2"> HOME=/home make tests"</span>
make <span class="nb">install
mv</span> <span class="nt">-vf</span> /usr/bin/bash /bin

<span class="nb">exec</span> /bin/bash <span class="nt">--login</span> +h
</code></pre></div></div>

<p>Con este último comando, lo que estaremos haciendo será ejecutar el programa <strong>Bash</strong> recientemente compilado, reemplazando así el que se está ejecutando actualmente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bmN.png">
</p>
<p><br></p>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="libtool-en-lfs">Libtool en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr
make
make check <span class="c"># Es posible que salgan errores, pero no hay de qué preocuparse</span>
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="gdbm-en-lfs">GDBM en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr    <span class="se">\</span>
            <span class="nt">--disable-static</span> <span class="se">\</span>
            <span class="nt">--enable-libgdbm-compat</span>

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="gperf-en-lfs">Gperf en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/gperf-3.1

make
make <span class="nt">-j1</span> check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="expat-en-lfs">Expat en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s|usr/bin/env |bin/|'</span> run.sh.in

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr    <span class="se">\</span>
            <span class="nt">--disable-static</span> <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/expat-2.2.9

make
make check
make <span class="nb">install

install</span> <span class="nt">-v</span> <span class="nt">-m644</span> doc/<span class="k">*</span>.<span class="o">{</span>html,png,css<span class="o">}</span> /usr/share/doc/expat-2.2.9
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="inetutils-en-lfs">Inetutils en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr        <span class="se">\</span>
            <span class="nt">--localstatedir</span><span class="o">=</span>/var <span class="se">\</span>
            <span class="nt">--disable-logger</span>     <span class="se">\</span>
            <span class="nt">--disable-whois</span>      <span class="se">\</span>
            <span class="nt">--disable-rcp</span>        <span class="se">\</span>
            <span class="nt">--disable-rexec</span>      <span class="se">\</span>
            <span class="nt">--disable-rlogin</span>     <span class="se">\</span>
            <span class="nt">--disable-rsh</span>        <span class="se">\</span>
            <span class="nt">--disable-servers</span>

make
make check
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/bin/<span class="o">{</span><span class="nb">hostname</span>,ping,ping6,traceroute<span class="o">}</span> /bin
<span class="nb">mv</span> <span class="nt">-v</span> /usr/bin/ifconfig /sbin
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<p>Sacaremos otra Snapshot antes de compilar el siguiente paquete:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34boh.png">
</p>
<p><br></p>

<h5 id="perl-en-lfs">Perl en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"127.0.0.1 localhost </span><span class="si">$(</span><span class="nb">hostname</span><span class="si">)</span><span class="s2">"</span> <span class="o">&gt;</span> /etc/hosts

<span class="nb">export </span><span class="nv">BUILD_ZLIB</span><span class="o">=</span>False
<span class="nb">export </span><span class="nv">BUILD_BZIP2</span><span class="o">=</span>0

sh Configure <span class="nt">-des</span> <span class="nt">-Dprefix</span><span class="o">=</span>/usr                 <span class="se">\</span>
                  <span class="nt">-Dvendorprefix</span><span class="o">=</span>/usr           <span class="se">\</span>
                  <span class="nt">-Dman1dir</span><span class="o">=</span>/usr/share/man/man1 <span class="se">\</span>
                  <span class="nt">-Dman3dir</span><span class="o">=</span>/usr/share/man/man3 <span class="se">\</span>
                  <span class="nt">-Dpager</span><span class="o">=</span><span class="s2">"/usr/bin/less -isR"</span>  <span class="se">\</span>
                  <span class="nt">-Duseshrplib</span>                  <span class="se">\</span>
                  <span class="nt">-Dusethreads</span>

make
make <span class="nb">test
</span>make <span class="nb">install
unset </span>BUILD_ZLIB BUILD_BZIP2
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="xml-parser-en-lfs">XML Parser en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl Makefile.PL
make
make <span class="nb">test
</span>make <span class="nb">install</span>
</code></pre></div></div>

<p>Como veis, es importante por ello tener bien compilado previamente el paquete de <strong>Perl</strong>.</p>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="intltool-en-lfs">Intltool en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s:\\\${:\\\$\\{:'</span> intltool-update.in

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check
make <span class="nb">install

install</span> <span class="nt">-v</span> <span class="nt">-Dm644</span> doc/I18N-HOWTO /usr/share/doc/intltool-0.51.0/I18N-HOWTO
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="autoconf-en-lfs">Autoconf en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'361 s/{/\\{/'</span> <span class="nt">-i</span> bin/autoscan.in

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check <span class="c"># Es posible que salgan errores, pero no hay de qué preocuparse</span>
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="automake-en-lfs">Automake en LFS</h5>

<p><strong>AVISO</strong>: Este paquete puede tardar bastante, así que toca armarse una vez más de paciencia.</p>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/automake-1.16.1


make
make <span class="nt">-j4</span> check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="kmod-en-lfs">Kmod en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr          <span class="se">\</span>
            <span class="nt">--bindir</span><span class="o">=</span>/bin          <span class="se">\</span>
            <span class="nt">--sysconfdir</span><span class="o">=</span>/etc      <span class="se">\</span>
            <span class="nt">--with-rootlibdir</span><span class="o">=</span>/lib <span class="se">\</span>
            <span class="nt">--with-xz</span>              <span class="se">\</span>
            <span class="nt">--with-zlib</span>

make
make <span class="nb">install

</span><span class="k">for </span>target <span class="k">in </span>depmod insmod lsmod modinfo modprobe rmmod<span class="p">;</span> <span class="k">do
  </span><span class="nb">ln</span> <span class="nt">-sfv</span> ../bin/kmod /sbin/<span class="nv">$target</span>
<span class="k">done

</span><span class="nb">ln</span> <span class="nt">-sfv</span> kmod /bin/lsmod
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="gettext-en-lfs">Gettext en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr    <span class="se">\</span>
            <span class="nt">--disable-static</span> <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/gettext-0.20.1

make
make check
make <span class="nb">install

chmod</span> <span class="nt">-v</span> 0755 /usr/lib/preloadable_libintl.so
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="libelf-de-elfutils-en-lfs">Libelf de Elfutils en LFS</h5>

<p>Este paquete corresponde al que tiene nombre <code class="language-plaintext highlighter-rouge">elfutils-0.178.tar.bz2</code>.</p>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--disable-debuginfod</span>

make
make check <span class="c"># Es posible que salgan errores, pero no hay de qué preocuparse</span>

make <span class="nt">-C</span> libelf <span class="nb">install
install</span> <span class="nt">-vm644</span> config/libelf.pc /usr/lib/pkgconfig
<span class="nb">rm</span> /usr/lib/libelf.a
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="libffi-en-lfs">Libffi en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--disable-static</span> <span class="nt">--with-gcc-arch</span><span class="o">=</span>native

make
make check <span class="c"># Es posible que salgan errores, pero no hay de qué preocuparse</span>
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="openssl-en-lfs">Openssl en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./config <span class="nt">--prefix</span><span class="o">=</span>/usr         <span class="se">\</span>
         <span class="nt">--openssldir</span><span class="o">=</span>/etc/ssl <span class="se">\</span>
         <span class="nt">--libdir</span><span class="o">=</span>lib          <span class="se">\</span>
         shared                <span class="se">\</span>
         zlib-dynamic

make
make <span class="nb">test</span> <span class="c"># Es posible que nos salgan fallos, pero no hay de qué preocuparse</span>

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/INSTALL_LIBS/s/libcrypto.a libssl.a//'</span> Makefile
make <span class="nv">MANSUFFIX</span><span class="o">=</span>ssl <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/share/doc/openssl /usr/share/doc/openssl-1.1.1d
<span class="nb">cp</span> <span class="nt">-vfr</span> doc/<span class="k">*</span> /usr/share/doc/openssl-1.1.1d
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="python3-en-lfs">Python3 en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr       <span class="se">\</span>
            <span class="nt">--enable-shared</span>     <span class="se">\</span>
            <span class="nt">--with-system-expat</span> <span class="se">\</span>
            <span class="nt">--with-system-ffi</span>   <span class="se">\</span>
            <span class="nt">--with-ensurepip</span><span class="o">=</span><span class="nb">yes

</span>make
make <span class="nb">install

</span>make <span class="nb">install
chmod</span> <span class="nt">-v</span> 755 /usr/lib/libpython3.8.so
<span class="nb">chmod</span> <span class="nt">-v</span> 755 /usr/lib/libpython3.so
<span class="nb">ln</span> <span class="nt">-sfv</span> pip3.8 /usr/bin/pip3

<span class="nb">install</span> <span class="nt">-v</span> <span class="nt">-dm755</span> /usr/share/doc/python-3.8.1/html 

<span class="nb">tar</span> <span class="nt">--strip-components</span><span class="o">=</span>1  <span class="se">\</span>
    <span class="nt">--no-same-owner</span>       <span class="se">\</span>
    <span class="nt">--no-same-permissions</span> <span class="se">\</span>
    <span class="nt">-C</span> /usr/share/doc/python-3.8.1/html <span class="se">\</span>
    <span class="nt">-xvf</span> ../python-3.8.1-docs-html.tar.bz2
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="ninja-en-lfs">Ninja en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NINJAJOBS</span><span class="o">=</span>4

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/int Guess/a \
  int   j = 0;\
  char* jobs = getenv( "NINJAJOBS" );\
  if ( jobs != NULL ) j = atoi( jobs );\
  if ( j &gt; 0 ) return j;\
'</span> src/ninja.cc

python3 configure.py <span class="nt">--bootstrap</span>

./ninja ninja_test
./ninja_test <span class="nt">--gtest_filter</span><span class="o">=</span><span class="nt">-SubprocessTest</span>.SetWithLots

<span class="nb">install</span> <span class="nt">-vm755</span> ninja /usr/bin/
<span class="nb">install</span> <span class="nt">-vDm644</span> misc/bash-completion /usr/share/bash-completion/completions/ninja
<span class="nb">install</span> <span class="nt">-vDm644</span> misc/zsh-completion  /usr/share/zsh/site-functions/_ninja
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="meson-en-lfs">Meson en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 setup.py build

python3 setup.py <span class="nb">install</span> <span class="nt">--root</span><span class="o">=</span>dest
<span class="nb">cp</span> <span class="nt">-rv</span> dest/<span class="k">*</span> /
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="coreutils-en-lfs">Coreutils en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>patch <span class="nt">-Np1</span> <span class="nt">-i</span> ../coreutils-8.31-i18n-1.patch

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/test.lock/s/^/#/'</span> gnulib-tests/gnulib.mk

autoreconf <span class="nt">-fiv</span>
<span class="nv">FORCE_UNSAFE_CONFIGURE</span><span class="o">=</span>1 ./configure <span class="se">\</span>
            <span class="nt">--prefix</span><span class="o">=</span>/usr            <span class="se">\</span>
            <span class="nt">--enable-no-install-program</span><span class="o">=</span><span class="nb">kill</span>,uptime

make
make <span class="nv">NON_ROOT_USERNAME</span><span class="o">=</span>nobody check-root

<span class="nb">echo</span> <span class="s2">"dummy:x:1000:nobody"</span> <span class="o">&gt;&gt;</span> /etc/group
<span class="nb">chown</span> <span class="nt">-Rv</span> nobody <span class="nb">.</span> 

su nobody <span class="nt">-s</span> /bin/bash <span class="se">\</span>
          <span class="nt">-c</span> <span class="s2">"PATH=</span><span class="nv">$PATH</span><span class="s2"> make RUN_EXPENSIVE_TESTS=yes check"</span> <span class="c"># Es posible que aparezcan errores, pero no hay de qué preocuparse</span>

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/dummy/d'</span> /etc/group

make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/bin/<span class="o">{</span><span class="nb">cat</span>,chgrp,chmod,chown,cp,date,dd,df,echo<span class="o">}</span> /bin
<span class="nb">mv</span> <span class="nt">-v</span> /usr/bin/<span class="o">{</span><span class="nb">false</span>,ln,ls,mkdir,mknod,mv,pwd,rm<span class="o">}</span> /bin
<span class="nb">mv</span> <span class="nt">-v</span> /usr/bin/<span class="o">{</span><span class="nb">rmdir</span>,stty,sync,true,uname<span class="o">}</span> /bin
<span class="nb">mv</span> <span class="nt">-v</span> /usr/bin/chroot /usr/sbin
<span class="nb">mv</span> <span class="nt">-v</span> /usr/share/man/man1/chroot.1 /usr/share/man/man8/chroot.8
<span class="nb">sed</span> <span class="nt">-i</span> s/<span class="se">\"</span>1<span class="se">\"</span>/<span class="se">\"</span>8<span class="se">\"</span>/1 /usr/share/man/man8/chroot.8

<span class="nb">mv</span> <span class="nt">-v</span> /usr/bin/<span class="o">{</span><span class="nb">head</span>,nice,sleep,touch<span class="o">}</span> /bin
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="check-en-lfs">Check en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr
make
make check

make <span class="nv">docdir</span><span class="o">=</span>/usr/share/doc/check-0.14.0 <span class="nb">install</span> <span class="o">&amp;&amp;</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'1 s/tools/usr/'</span> /usr/bin/checkmk
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="diffutils-en-lfs">Diffutils en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="gawk-en-lfs">Gawk en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/extras//'</span> Makefile.in

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check
make <span class="nb">install

mkdir</span> <span class="nt">-v</span> /usr/share/doc/gawk-5.0.1
<span class="nb">cp</span>    <span class="nt">-v</span> doc/<span class="o">{</span>awkforai.txt,<span class="k">*</span>.<span class="o">{</span>eps,pdf,jpg<span class="o">}}</span> /usr/share/doc/gawk-5.0.1
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="findutils-en-lfs">Findutils en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--localstatedir</span><span class="o">=</span>/var/lib/locate

make
make check <span class="c"># Este comando puede mostrar algunos errores, pero no hay de qué preocuparse</span>
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/bin/find /bin
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s|find:=${BINDIR}|find:=/bin|'</span> /usr/bin/updatedb
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="groff-en-lfs">Groff en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PAGE</span><span class="o">=</span>A4 ./configure <span class="nt">--prefix</span><span class="o">=</span>/usr
make <span class="nt">-j1</span>
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="grub-en-lfs">GRUB en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr          <span class="se">\</span>
            <span class="nt">--sbindir</span><span class="o">=</span>/sbin        <span class="se">\</span>
            <span class="nt">--sysconfdir</span><span class="o">=</span>/etc      <span class="se">\</span>
            <span class="nt">--disable-efiemu</span>       <span class="se">\</span>
            <span class="nt">--disable-werror</span>

make
make <span class="nb">install

mv</span> <span class="nt">-v</span> /etc/bash_completion.d/grub /usr/share/bash-completion/completions
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="less-en-lfs">Less en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--sysconfdir</span><span class="o">=</span>/etc

make
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="gzip-en-lfs">Gzip en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check <span class="c"># Es posible que aparezcan fallos, pero no hay de qué preocuparse</span>
make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/bin/gzip /bin
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="zstd-en-lfs">Zstd en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make
make <span class="nv">prefix</span><span class="o">=</span>/usr <span class="nb">install

rm</span> <span class="nt">-v</span> /usr/lib/libzstd.a
<span class="nb">mv</span> <span class="nt">-v</span> /usr/lib/libzstd.so.<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libzstd.so<span class="si">)</span> /usr/lib/libzstd.so
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="iproute-en-lfs">IPRoute en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> /ARPD/d Makefile
<span class="nb">rm</span> <span class="nt">-fv</span> man/man8/arpd.8

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/.m_ipt.o//'</span> tc/Makefile

make
make <span class="nv">DOCDIR</span><span class="o">=</span>/usr/share/doc/iproute2-5.5.0 <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="kbd-en-lfs">Kbd en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>patch <span class="nt">-Np1</span> <span class="nt">-i</span> ../kbd-2.2.0-backspace-1.patch

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/\(RESIZECONS_PROGS=\)yes/\1no/g'</span> configure
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/resizecons.8 //'</span> docs/man/man8/Makefile.in

<span class="nv">PKG_CONFIG_PATH</span><span class="o">=</span>/tools/lib/pkgconfig ./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--disable-vlock</span>

make
make check
make <span class="nb">install

mkdir</span> <span class="nt">-v</span>       /usr/share/doc/kbd-2.2.0
<span class="nb">cp</span> <span class="nt">-R</span> <span class="nt">-v</span> docs/doc/<span class="k">*</span> /usr/share/doc/kbd-2.2.0
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="libpipeline-en-lfs">Libpipeline en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="make-en-lfs">Make en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make <span class="nv">PERL5LIB</span><span class="o">=</span><span class="nv">$PWD</span>/tests/ check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="patch-en-lfs">Patch en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="man-db-en-lfs">MAN DB en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr                        <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/man-db-2.9.0 <span class="se">\</span>
            <span class="nt">--sysconfdir</span><span class="o">=</span>/etc                    <span class="se">\</span>
            <span class="nt">--disable-setuid</span>                     <span class="se">\</span>
            <span class="nt">--enable-cache-owner</span><span class="o">=</span>bin             <span class="se">\</span>
            <span class="nt">--with-browser</span><span class="o">=</span>/usr/bin/lynx         <span class="se">\</span>
            <span class="nt">--with-vgrind</span><span class="o">=</span>/usr/bin/vgrind        <span class="se">\</span>
            <span class="nt">--with-grap</span><span class="o">=</span>/usr/bin/grap            <span class="se">\</span>
            <span class="nt">--with-systemdtmpfilesdir</span><span class="o">=</span>           <span class="se">\</span>
            <span class="nt">--with-systemdsystemunitdir</span><span class="o">=</span>

make
make check
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="tar-en-lfs">Tar en LFS</h5>

<p><strong>AVISO</strong>: La instalación de este paquete puede demorar un buen rato.</p>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">FORCE_UNSAFE_CONFIGURE</span><span class="o">=</span>1  <span class="se">\</span>
./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="se">\</span>
            <span class="nt">--bindir</span><span class="o">=</span>/bin

make
make check
make <span class="nb">install

</span>make <span class="nt">-C</span> doc install-html <span class="nv">docdir</span><span class="o">=</span>/usr/share/doc/tar-1.32
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="texinfo-en-lfs">Texinfo en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr <span class="nt">--disable-static</span>

make
make check
make <span class="nb">install

</span>make <span class="nv">TEXMF</span><span class="o">=</span>/usr/share/texmf install-tex

<span class="nb">pushd</span> /usr/share/info
<span class="nb">rm</span> <span class="nt">-v</span> <span class="nb">dir
</span><span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>
  <span class="k">do </span>install-info <span class="nv">$f</span> <span class="nb">dir </span>2&gt;/dev/null
<span class="k">done
</span><span class="nb">popd</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="vim-en-lfs">Vim en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'#define SYS_VIMRC_FILE "/etc/vimrc"'</span> <span class="o">&gt;&gt;</span> src/feature.h

./configure <span class="nt">--prefix</span><span class="o">=</span>/usr

make

<span class="nb">chown</span> <span class="nt">-Rv</span> nobody <span class="nb">.</span>
su nobody <span class="nt">-s</span> /bin/bash <span class="nt">-c</span> <span class="s2">"LANG=en_US.UTF-8 make -j1 test"</span> &amp;&gt; vim-test.log
make <span class="nb">install

ln</span> <span class="nt">-sv</span> vim /usr/bin/vi
<span class="k">for </span>L <span class="k">in</span>  /usr/share/man/<span class="o">{</span>,<span class="k">*</span>/<span class="o">}</span>man1/vim.1<span class="p">;</span> <span class="k">do
    </span><span class="nb">ln</span> <span class="nt">-sv</span> vim.1 <span class="si">$(</span><span class="nb">dirname</span> <span class="nv">$L</span><span class="si">)</span>/vi.1
<span class="k">done

</span><span class="nb">ln</span> <span class="nt">-sv</span> ../vim/vim82/doc /usr/share/doc/vim-8.2.0190

<span class="nb">cat</span> <span class="o">&gt;</span> /etc/vimrc &lt;&lt; <span class="s2">"EOF"</span>
<span class="s2">" Begin /etc/vimrc

"</span> Ensure defaults are <span class="nb">set </span>before customizing settings, not after
<span class="nb">source</span> <span class="nv">$VIMRUNTIME</span>/defaults.vim
<span class="nb">let </span><span class="nv">skip_defaults_vim</span><span class="o">=</span>1 

<span class="nb">set </span>nocompatible
<span class="nb">set </span><span class="nv">backspace</span><span class="o">=</span>2
<span class="nb">set </span><span class="nv">mouse</span><span class="o">=</span>
syntax on
<span class="k">if</span> <span class="o">(</span>&amp;term <span class="o">==</span> <span class="s2">"xterm"</span><span class="o">)</span> <span class="o">||</span> <span class="o">(</span>&amp;term <span class="o">==</span> <span class="s2">"putty"</span><span class="o">)</span>
  <span class="nb">set </span><span class="nv">background</span><span class="o">=</span>dark
endif

<span class="s2">" End /etc/vimrc
EOF
</span></code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="procps-en-lfs">Procps en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr                            <span class="se">\</span>
            <span class="nt">--exec-prefix</span><span class="o">=</span>                           <span class="se">\</span>
            <span class="nt">--libdir</span><span class="o">=</span>/usr/lib                        <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/procps-ng-3.3.15 <span class="se">\</span>
            <span class="nt">--disable-static</span>                         <span class="se">\</span>
            <span class="nt">--disable-kill</span>

make

<span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-r</span> <span class="s1">'s|(pmap_initname)\\\$|\1|'</span> testsuite/pmap.test/pmap.exp
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/set tty/d'</span> testsuite/pkill.test/pkill.exp
<span class="nb">rm </span>testsuite/pgrep.test/pgrep.exp
make check

make <span class="nb">install

mv</span> <span class="nt">-v</span> /usr/lib/libprocps.so.<span class="k">*</span> /lib
<span class="nb">ln</span> <span class="nt">-sfv</span> ../../lib/<span class="si">$(</span><span class="nb">readlink</span> /usr/lib/libprocps.so<span class="si">)</span> /usr/lib/libprocps.so
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="util-linux-en-lfs">Util Linux en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-pv</span> /var/lib/hwclock

./configure <span class="nv">ADJTIME_PATH</span><span class="o">=</span>/var/lib/hwclock/adjtime   <span class="se">\</span>
            <span class="nt">--docdir</span><span class="o">=</span>/usr/share/doc/util-linux-2.35.1 <span class="se">\</span>
            <span class="nt">--disable-chfn-chsh</span>  <span class="se">\</span>
            <span class="nt">--disable-login</span>      <span class="se">\</span>
            <span class="nt">--disable-nologin</span>    <span class="se">\</span>
            <span class="nt">--disable-su</span>         <span class="se">\</span>
            <span class="nt">--disable-setpriv</span>    <span class="se">\</span>
            <span class="nt">--disable-runuser</span>    <span class="se">\</span>
            <span class="nt">--disable-pylibmount</span> <span class="se">\</span>
            <span class="nt">--disable-static</span>     <span class="se">\</span>
            <span class="nt">--without-python</span>     <span class="se">\</span>
            <span class="nt">--without-systemd</span>    <span class="se">\</span>
            <span class="nt">--without-systemdsystemunitdir</span>

make

<span class="nb">chown</span> <span class="nt">-Rv</span> nobody <span class="nb">.</span>
su nobody <span class="nt">-s</span> /bin/bash <span class="nt">-c</span> <span class="s2">"PATH=</span><span class="nv">$PATH</span><span class="s2"> make -k check"</span>

make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="e2fsprogs-en-lfs">E2fsprogs en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-v</span> build
<span class="nb">cd </span>build

../configure <span class="nt">--prefix</span><span class="o">=</span>/usr           <span class="se">\</span>
             <span class="nt">--bindir</span><span class="o">=</span>/bin           <span class="se">\</span>
             <span class="nt">--with-root-prefix</span><span class="o">=</span><span class="s2">""</span>   <span class="se">\</span>
             <span class="nt">--enable-elf-shlibs</span>     <span class="se">\</span>
             <span class="nt">--disable-libblkid</span>      <span class="se">\</span>
             <span class="nt">--disable-libuuid</span>       <span class="se">\</span>
             <span class="nt">--disable-uuidd</span>         <span class="se">\</span>
             <span class="nt">--disable-fsck</span>

make
make check
make <span class="nb">install

chmod</span> <span class="nt">-v</span> u+w /usr/lib/<span class="o">{</span>libcom_err,libe2p,libext2fs,libss<span class="o">}</span>.a

<span class="nb">gunzip</span> <span class="nt">-v</span> /usr/share/info/libext2fs.info.gz
install-info <span class="nt">--dir-file</span><span class="o">=</span>/usr/share/info/dir /usr/share/info/libext2fs.info

makeinfo <span class="nt">-o</span>      doc/com_err.info ../lib/et/com_err.texinfo
<span class="nb">install</span> <span class="nt">-v</span> <span class="nt">-m644</span> doc/com_err.info /usr/share/info
install-info <span class="nt">--dir-file</span><span class="o">=</span>/usr/share/info/dir /usr/share/info/com_err.info
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="sysklogd-en-lfs">Sysklogd en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/Error loading kernel symbols/{n;n;d}'</span> ksym_mod.c
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/union wait/int/'</span> syslogd.c

make

make <span class="nv">BINDIR</span><span class="o">=</span>/sbin <span class="nb">install

cat</span> <span class="o">&gt;</span> /etc/syslog.conf &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/syslog.conf</span>

auth,authpriv.<span class="k">*</span> -/var/log/auth.log
<span class="k">*</span>.<span class="k">*</span><span class="p">;</span>auth,authpriv.none -/var/log/sys.log
daemon.<span class="k">*</span> -/var/log/daemon.log
kern.<span class="k">*</span> -/var/log/kern.log
mail.<span class="k">*</span> -/var/log/mail.log
user.<span class="k">*</span> -/var/log/user.log
<span class="k">*</span>.emerg <span class="k">*</span>

<span class="c"># End /etc/syslog.conf</span>
EOF
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="sysvinit-en-lfs">Sysvinit en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>patch <span class="nt">-Np1</span> <span class="nt">-i</span> ../sysvinit-2.96-consolidated-1.patch

make
make <span class="nb">install</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<h5 id="eudev-en-lfs">Eudev en LFS</h5>

<p>Para la instalación de este paquete, una vez descomprimido el comprimido correspondiente, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure <span class="nt">--prefix</span><span class="o">=</span>/usr           <span class="se">\</span>
            <span class="nt">--bindir</span><span class="o">=</span>/sbin          <span class="se">\</span>
            <span class="nt">--sbindir</span><span class="o">=</span>/sbin         <span class="se">\</span>
            <span class="nt">--libdir</span><span class="o">=</span>/usr/lib       <span class="se">\</span>
            <span class="nt">--sysconfdir</span><span class="o">=</span>/etc       <span class="se">\</span>
            <span class="nt">--libexecdir</span><span class="o">=</span>/lib       <span class="se">\</span>
            <span class="nt">--with-rootprefix</span><span class="o">=</span>      <span class="se">\</span>
            <span class="nt">--with-rootlibdir</span><span class="o">=</span>/lib  <span class="se">\</span>
            <span class="nt">--enable-manpages</span>       <span class="se">\</span>
            <span class="nt">--disable-static</span>

make

<span class="nb">mkdir</span> <span class="nt">-pv</span> /lib/udev/rules.d
<span class="nb">mkdir</span> <span class="nt">-pv</span> /etc/udev/rules.d

make check
make <span class="nb">install

tar</span> <span class="nt">-xvf</span> ../udev-lfs-20171102.tar.xz
make <span class="nt">-f</span> udev-lfs-20171102/Makefile.lfs <span class="nb">install

</span>udevadm hwdb <span class="nt">--update</span>
</code></pre></div></div>

<p>Una vez finalizada la instalación, retrocedemos los directorios necesarios y borramos el directorio principal del descomprimido.</p>

<p>Ya en este punto, creamos una Snapshot:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bSs.png">
</p>
<p><br></p>

<h4 id="limpieza-final">Limpieza Final</h4>

<p>Comenzaremos colocando los símbolos de depuración para las bibliotecas seleccionadas en archivos separados:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">save_lib</span><span class="o">=</span><span class="s2">"ld-2.31.so libc-2.31.so libpthread-2.31.so libthread_db-1.0.so"</span>

<span class="nb">cd</span> /lib

<span class="k">for </span>LIB <span class="k">in</span> <span class="nv">$save_lib</span><span class="p">;</span> <span class="k">do
    </span>objcopy <span class="nt">--only-keep-debug</span> <span class="nv">$LIB</span> <span class="nv">$LIB</span>.dbg 
    strip <span class="nt">--strip-unneeded</span> <span class="nv">$LIB</span>
    objcopy <span class="nt">--add-gnu-debuglink</span><span class="o">=</span><span class="nv">$LIB</span>.dbg <span class="nv">$LIB</span> 
<span class="k">done    

</span><span class="nv">save_usrlib</span><span class="o">=</span><span class="s2">"libquadmath.so.0.0.0 libstdc++.so.6.0.27
             libitm.so.1.0.0 libatomic.so.1.2.0"</span> 

<span class="nb">cd</span> /usr/lib

<span class="k">for </span>LIB <span class="k">in</span> <span class="nv">$save_usrlib</span><span class="p">;</span> <span class="k">do
    </span>objcopy <span class="nt">--only-keep-debug</span> <span class="nv">$LIB</span> <span class="nv">$LIB</span>.dbg
    strip <span class="nt">--strip-unneeded</span> <span class="nv">$LIB</span>
    objcopy <span class="nt">--add-gnu-debuglink</span><span class="o">=</span><span class="nv">$LIB</span>.dbg <span class="nv">$LIB</span>
<span class="k">done

</span><span class="nb">unset </span>LIB save_lib save_usrlib
</code></pre></div></div>

<p>Antes de realizar la eliminación, deberemos tener especial cuidado para asegurarnos de que ninguno de los binarios que están a punto de ser borrados se estén ejecutando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec</span> /tools/bin/bash
</code></pre></div></div>

<p>Una vez hecho, ahora los binarios y las bibliotecas se pueden quitar de forma segura:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/tools/bin/find /usr/lib <span class="nt">-type</span> f <span class="nt">-name</span> <span class="se">\*</span>.a <span class="se">\</span>
   <span class="nt">-exec</span> /tools/bin/strip <span class="nt">--strip-debug</span> <span class="o">{}</span> <span class="s1">';'</span>

/tools/bin/find /lib /usr/lib <span class="nt">-type</span> f <span class="se">\(</span> <span class="nt">-name</span> <span class="se">\*</span>.so<span class="k">*</span> <span class="nt">-a</span> <span class="o">!</span> <span class="nt">-name</span> <span class="se">\*</span>dbg <span class="se">\)</span> <span class="se">\</span>
   <span class="nt">-exec</span> /tools/bin/strip <span class="nt">--strip-unneeded</span> <span class="o">{}</span> <span class="s1">';'</span>

/tools/bin/find /<span class="o">{</span>bin,sbin<span class="o">}</span> /usr/<span class="o">{</span>bin,sbin,libexec<span class="o">}</span> <span class="nt">-type</span> f <span class="se">\</span>
    <span class="nt">-exec</span> /tools/bin/strip <span class="nt">--strip-all</span> <span class="o">{}</span> <span class="s1">';'</span>
</code></pre></div></div>

<p>Finalmente, limpiamos algunos archivos adicionales que quedan de las pruebas en ejecución:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-rf</span> /tmp/<span class="k">*</span>
</code></pre></div></div>

<p>Y ya en este punto, lo que haremos será cerrar sesión y volver a ingresar al entorno chroot con un comando chroot esta vez actualizado.</p>

<p><strong>IMPORTANTE</strong>: A partir de ahora, en caso de necesitar volver a ingresar al entorno chroot tras salir, deberemos de ejecutar el comando que indico a continuación:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exit

chroot</span> <span class="s2">"</span><span class="nv">$LFS</span><span class="s2">"</span> /usr/bin/env <span class="nt">-i</span>          <span class="se">\</span>
    <span class="nv">HOME</span><span class="o">=</span>/root <span class="nv">TERM</span><span class="o">=</span><span class="s2">"</span><span class="nv">$TERM</span><span class="s2">"</span>            <span class="se">\</span>
    <span class="nv">PS1</span><span class="o">=</span><span class="s1">'(lfs chroot) \u:\w\$ '</span>        <span class="se">\</span>
    <span class="nv">PATH</span><span class="o">=</span>/bin:/usr/bin:/sbin:/usr/sbin <span class="se">\</span>
    /bin/bash <span class="nt">--login</span>
</code></pre></div></div>

<p>Una vez dentro, eliminaremos las siguientes biliotecas estáticas las cuales pueden ser borradas sin problema:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-f</span> /usr/lib/lib<span class="o">{</span>bfd,opcodes<span class="o">}</span>.a
<span class="nb">rm</span> <span class="nt">-f</span> /usr/lib/libbz2.a
<span class="nb">rm</span> <span class="nt">-f</span> /usr/lib/lib<span class="o">{</span>com_err,e2p,ext2fs,ss<span class="o">}</span>.a
<span class="nb">rm</span> <span class="nt">-f</span> /usr/lib/libltdl.a
<span class="nb">rm</span> <span class="nt">-f</span> /usr/lib/libfl.a
<span class="nb">rm</span> <span class="nt">-f</span> /usr/lib/libz.a
</code></pre></div></div>

<p>Así como los archivos instalados en los directorios ‘<em>/usr/lib</em>’ y ‘<em>/usr/libexec</em>’:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find /usr/lib /usr/libexec <span class="nt">-name</span> <span class="se">\*</span>.la <span class="nt">-delete</span>
</code></pre></div></div>

<h4 id="configuración-del-sistema">Configuración del sistema</h4>
<h5 id="instalación-de-lfs-bootscripts">Instalación de LFS Bootscripts</h5>

<p>Lo que haremos será dirigirnos al directorio ‘<em>/sources</em>’ y descomprimir el comprimido correspondiente para este paquete. Una vez descomprimido, aplicaremos el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nb">install</span>
</code></pre></div></div>

<h5 id="gestión-de-dispositivos">Gestión de dispositivos</h5>

<p>Comenzaremos creando unas reglas de <strong>Udev</strong> personalizadas. Para ello, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash /lib/udev/init-net-rules.sh
<span class="nb">cat</span> /etc/udev/rules.d/70-persistent-net.rules
</code></pre></div></div>

<p>Deberíamos ver un output como el siguiente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bTu.png">
</p>
<p><br></p>

<p>Sobre este archivo, efectuaremos un pequeño cambio. Como podréis apreciar en la imagen de arriba, el nombre de la interfaz es <strong>enp0s3</strong>, en mi caso lo voy a llamar <strong>eth0</strong>, por tanto abriremos el archivo, lo cambiaremos y posteriormente volveremos a ejecutar los mismos comandos:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bTN.png">
</p>
<p><br></p>

<p>Una vez hecho, ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>udevadm <span class="nb">test</span> /sys/block/sr0

<span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-e</span> <span class="s1">'s/"write_cd_rules"/"write_cd_rules by-id"/'</span> <span class="se">\</span>
    /etc/udev/rules.d/83-cdrom-symlinks.rules
</code></pre></div></div>

<p>Deberíamos ver un output como el siguiente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bUo.png">
</p>
<p><br></p>

<p>El archivo situado en <code class="language-plaintext highlighter-rouge">/etc/udev/rules.d/83-cdrom-symlinks.rules</code> debe de tener el siguiente contenido:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bUp.png">
</p>
<p><br></p>

<p>Por último, para manejar dispositivos duplicados, ejecutaremos el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/udev/rules.d/83-duplicate_devs.rules &lt;&lt; <span class="s2">"EOF"</span>

<span class="c"># Persistent symlinks for webcam and tuner</span>
<span class="nv">KERNEL</span><span class="o">==</span><span class="s2">"video*"</span>, ATTRS<span class="o">{</span>idProduct<span class="o">}==</span><span class="s2">"1910"</span>, ATTRS<span class="o">{</span>idVendor<span class="o">}==</span><span class="s2">"0d81"</span>, <span class="se">\</span>
    SYMLINK+<span class="o">=</span><span class="s2">"webcam"</span>
<span class="nv">KERNEL</span><span class="o">==</span><span class="s2">"video*"</span>, ATTRS<span class="o">{</span>device<span class="o">}==</span><span class="s2">"0x036f"</span>, ATTRS<span class="o">{</span>vendor<span class="o">}==</span><span class="s2">"0x109e"</span>, <span class="se">\</span>
    SYMLINK+<span class="o">=</span><span class="s2">"tvtuner"</span>

EOF
</code></pre></div></div>

<h5 id="creación-de-archivos-de-configuración-de-interfaz-de-red">Creación de archivos de configuración de interfaz de red</h5>

<p>Nos dirigiremos a la ruta <code class="language-plaintext highlighter-rouge">/etc/sysconfig</code> y nos crearemos un fichero con nombre <code class="language-plaintext highlighter-rouge">ifconfig.eth0</code> que posea la siguiente estructura:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> ifconfig.eth0 &lt;&lt; <span class="s2">"EOF"</span>
<span class="nv">ONBOOT</span><span class="o">=</span><span class="nb">yes
</span><span class="nv">IFACE</span><span class="o">=</span>eth0
<span class="nv">SERVICE</span><span class="o">=</span>ipv4-static
<span class="nv">IP</span><span class="o">=</span>192.168.1.2
<span class="nv">GATEWAY</span><span class="o">=</span>192.168.1.1
<span class="nv">PREFIX</span><span class="o">=</span>24
<span class="nv">BROADCAST</span><span class="o">=</span>192.168.1.255
EOF
</code></pre></div></div>

<p>En mi caso, lo adaptaré a mi segmento de red:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bUP.png">
</p>
<p><br></p>

<p>Por otro lado, añadiremos el archivo <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> con el siguiente contenido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/resolv.conf &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/resolv.conf</span>

domain &lt;Your Domain Name&gt;
nameserver &lt;IP address of your primary nameserver&gt;
nameserver &lt;IP address of your secondary nameserver&gt;

<span class="c"># End /etc/resolv.conf</span>
EOF
</code></pre></div></div>

<p>Obviamente, cambiaremos sus valores a los correspondientes:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bUZ.png">
</p>
<p><br></p>

<h5 id="configurando-el-nombre-de-host-del-sistema">Configurando el nombre de host del sistema</h5>

<p>Durante el proceso de arranque, el archivo <code class="language-plaintext highlighter-rouge">/etc/hostname</code> se usa para establecer el nombre de host del sistema.</p>

<p>Lo que haremos será crear este archivo donde ingresaremos nuestro nombre de host:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"s4viOS"</span> <span class="o">&gt;</span> /etc/hostname
</code></pre></div></div>

<p>Por otro lado, nos crearemos el archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code> con el siguiente contenido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/hosts &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/hosts</span>

127.0.0.1 localhost
127.0.1.1 &lt;FQDN&gt; &lt;HOSTNAME&gt;
&lt;192.168.1.1&gt; &lt;FQDN&gt; &lt;HOSTNAME&gt; <span class="o">[</span>alias1] <span class="o">[</span>alias2 ...]
::1       localhost ip6-localhost ip6-loopback
ff02::1   ip6-allnodes
ff02::2   ip6-allrouters

<span class="c"># End /etc/hosts</span>
EOF
</code></pre></div></div>

<p>Posteriormente, lo adaptaremos a nuestras necesidades:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bW6.png">
</p>
<p><br></p>

<h5 id="configurando-el-sysvinit">Configurando el Sysvinit</h5>

<p>Durante la inicialización del núcleo, el primer programa que se ejecuta se especifica en la línea de comando o, por defecto, <strong>init</strong>. Este programa lee el archivo de inicialización ‘<em>/etc/inittab</em>’.</p>

<p>La idea será crear este archivo con el siguiente contenido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/inittab &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/inittab</span>

<span class="nb">id</span>:3:initdefault:

si::sysinit:/etc/rc.d/init.d/rc S

l0:0:wait:/etc/rc.d/init.d/rc 0
l1:S1:wait:/etc/rc.d/init.d/rc 1
l2:2:wait:/etc/rc.d/init.d/rc 2
l3:3:wait:/etc/rc.d/init.d/rc 3
l4:4:wait:/etc/rc.d/init.d/rc 4
l5:5:wait:/etc/rc.d/init.d/rc 5
l6:6:wait:/etc/rc.d/init.d/rc 6

ca:12345:ctrlaltdel:/sbin/shutdown <span class="nt">-t1</span> <span class="nt">-a</span> <span class="nt">-r</span> now

su:S016:once:/sbin/sulogin

1:2345:respawn:/sbin/agetty <span class="nt">--noclear</span> tty1 9600
2:2345:respawn:/sbin/agetty tty2 9600
3:2345:respawn:/sbin/agetty tty3 9600
4:2345:respawn:/sbin/agetty tty4 9600
5:2345:respawn:/sbin/agetty tty5 9600
6:2345:respawn:/sbin/agetty tty6 9600

<span class="c"># End /etc/inittab</span>
EOF
</code></pre></div></div>

<h5 id="configuración-del-reloj-del-sistema">Configuración del reloj del sistema</h5>

<p>Crearemos un archivo en ‘<em>/etc/sysconfig/clock</em>’ con el siguiente contenido:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/sysconfig/clock &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/sysconfig/clock</span>

<span class="nv">UTC</span><span class="o">=</span>1

<span class="c"># Set this to any options you might need to give to hwclock,</span>
<span class="c"># such as machine hardware clock type for Alphas.</span>
<span class="nv">CLOCKPARAMS</span><span class="o">=</span>

<span class="c"># End /etc/sysconfig/clock</span>
EOF
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/34bWL.png">
</p>
<p><br></p>

<h5 id="configuración-de-la-consola-de-linux">Configuración de la consola de Linux</h5>

<p>En este punto, configuraremos el script de consola que configura el mapa del teclado, la fuente de la consola y el nivel de registro del kernel de la consola.</p>

<p>Nos crearemos un archivo en <code class="language-plaintext highlighter-rouge">/etc/sysconfig/console</code> con el siguiente contenido (cada uno lo puede adaptar a sus necesidades):</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bXf.png">
</p>
<p><br></p>

<h5 id="creando-archivo-rc-site">Creando archivo rc site</h5>

<p>Este archivo se sitúa en ‘<em>/etc/sysconfig/rc.site</em>’ y ya posee contenido. Lo que haremos será cambiar algunas cosas de este archivo.</p>

<p>Empezaremos por los siguientes datos:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bXJ.png">
</p>
<p><br></p>

<p>Posteriormente, descomentaremos las siguientes líneas:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bXW.png">
</p>
<p><br></p>

<p>También descomentaremos las siguientes y cambiaremos sus valores respectivos a <strong>yes</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bXV.png">
</p>
<p><br></p>

<p>Por último, cambiaremos el valor del <strong>HOSTNAME</strong> y descomentaremos la línea del <strong>SYSKLOGD</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bYf.png">
</p>
<p><br></p>

<h4 id="archivos-de-inicio-de-bash-shell">Archivos de inicio de Bash Shell</h4>

<p>El programa de shell <strong>/bin/bash</strong> utiliza una colección de archivos de inicio para ayudar a crear un entorno en el que ejecutarse. Cada archivo tiene un uso específico y puede afectar el inicio de sesión, así como los entornos interactivos de manera diferente.</p>

<p>Los archivos ‘<em>/etc/profile</em>’ y ‘<em>~/.bash_profile</em>’ son leídos en el momento en el que se invoca la shell como una shell de inicio de sesión interactivo.</p>

<p>La lista de todos los entornos locales compatibles con Glibc se pueden obtener ejecutando el siguiente comando:</p>

<p><code class="language-plaintext highlighter-rouge">locale -a</code></p>

<p>Simplemente seguid mis pasos para configurarlo de la misma manera:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bZq.png">
</p>
<p><br></p>

<p>Una vez hecho, ya estamos listos para adaptar nuestro fichero <strong>profile</strong>. En este caso, también crearemos de una tirada el archivo <strong>inputrc</strong>, un archivo de configuración de la biblioteca Readline, que proporciona capacidades de edición mientras el usuario ingresa una línea desde la terminal.</p>

<p>Este funciona traduciendo las entradas del teclado en acciones específicas:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34bZr.png">
</p>
<p><br></p>

<p>Por otro lado, crearemos el archivo ‘<em>/etc/shells</em>’, el cual contiene una lista de shells de inicio de sesión en el sistema:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/shells &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/shells</span>

/bin/sh
/bin/bash

<span class="c"># End /etc/shells</span>
EOF
</code></pre></div></div>

<h1 id="haciendo-nuestro-sistema-booteable">Haciendo nuestro sistema booteable</h1>

<h4 id="creando-archivo-fstab">Creando archivo fstab</h4>

<p>El archivo <strong>fstab</strong> es utilizado por algunos programas para determinar dónde los sistemas de archivos deben de ser montados de forma predeterminada, en qué orden, y qué debe ser comprobado antes del montaje.</p>

<p>Lo que haremos será crear una nueva tabla de sistemas de archivos como esta:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/fstab &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/fstab</span>

<span class="c"># file system  mount-point  type     options             dump  fsck</span>
<span class="c">#                                                              order</span>

/dev/&lt;xxx&gt;     /            &lt;fff&gt;    defaults            1     1
/dev/&lt;yyy&gt;     swap         swap     <span class="nv">pri</span><span class="o">=</span>1               0     0
proc           /proc        proc     nosuid,noexec,nodev 0     0
sysfs          /sys         sysfs    nosuid,noexec,nodev 0     0
devpts         /dev/pts     devpts   <span class="nv">gid</span><span class="o">=</span>5,mode<span class="o">=</span>620      0     0
tmpfs          /run         tmpfs    defaults            0     0
devtmpfs       /dev         devtmpfs <span class="nv">mode</span><span class="o">=</span>0755,nosuid    0     0

<span class="c"># End /etc/fstab</span>
EOF
</code></pre></div></div>

<p>En ella, ajustaremos los siguientes valores:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c1v.png">
</p>
<p><br></p>

<p>Probablemente estarás pensando en que me he equivocado con los nombres, ¡pero no!… la idea será que <strong>sdb</strong> pase a convertirse a <strong>sda</strong>, ahora lo veréis con mayor detalle.</p>

<h4 id="instalación-del-kernel">Instalación del Kernel</h4>

<p>Nos dirigiremos a la ruta ‘<em>/sources</em>’, y descomprimiremos el siguiente comprimido, aplicando a su vez los siguientes comandos:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c1T.png">
</p>
<p><br></p>

<p>Una vez hecho, abriremos con <strong>vi</strong> el archivo <strong>.config</strong> generado y haremos las siguientes comprobaciones:</p>

<ul>
  <li>Confirmamos que <strong>CONFIG_DEVTMPFS=y</strong>
</li>
  <li>Confirmamos que <strong>CONFIG_EFI_STUV=y</strong>
</li>
  <li>Confirmamos que <strong>CONFIG_UEVENT_HELPER</strong> no esté seteado</li>
</ul>

<p align="center">
     <img src="https://funkyimg.com/i/34c22.png">
</p>
<p><br></p>

<p>Si esto es así, podremos continuar sin problemas.</p>

<p>Ahora bien, lo que haremos será ejecutar el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make menuconfig
</code></pre></div></div>

<p>Esto nos abrirá el siguiente menú:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c2c.png">
</p>
<p><br></p>

<p>En este menú, nos iremos a la opción que pone <strong>General Setup</strong>. Una vez dentro, veremos lo siguiente:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c2d.png">
</p>
<p><br></p>

<p>En este punto, cambiaremos el valor de <strong>Default hostname</strong> al de nuestro sistema, en mi caso… <strong>S4viOS</strong>:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c2e.png">
</p>
<p><br></p>

<p>Una vez cambiado, salimos y guardamos los cambios.</p>

<p>Ya fuera, aplicamos los siguientes comandos para efectuar la compilación:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make
make modules_install
</code></pre></div></div>

<p>Una vez hecho, continuamos con los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> <span class="nt">-iv</span> <span class="nb">arch</span>/x86/boot/bzImage /boot/vmlinuz-5.5.3-lfs-9.1
<span class="nb">cp</span> <span class="nt">-iv</span> System.map /boot/System.map-5.5.3
<span class="nb">cp</span> <span class="nt">-iv</span> .config /boot/config-5.5.3
<span class="nb">install</span> <span class="nt">-d</span> /usr/share/doc/linux-5.5.3
<span class="nb">cp</span> <span class="nt">-r</span> Documentation/<span class="k">*</span> /usr/share/doc/linux-5.5.3

<span class="nb">chown</span> <span class="nt">-R</span> 0:0 <span class="nb">.</span>
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/34c4b.png">
</p>
<p><br></p>

<p>Para terminar, ejecutamos estos últimos comandos antes de empezar con el GRUB:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">install</span> <span class="nt">-v</span> <span class="nt">-m755</span> <span class="nt">-d</span> /etc/modprobe.d
<span class="nb">cat</span> <span class="o">&gt;</span> /etc/modprobe.d/usb.conf &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /etc/modprobe.d/usb.conf</span>

<span class="nb">install </span>ohci_hcd /sbin/modprobe ehci_hcd <span class="p">;</span> /sbin/modprobe <span class="nt">-i</span> ohci_hcd <span class="p">;</span> <span class="nb">true
install </span>uhci_hcd /sbin/modprobe ehci_hcd <span class="p">;</span> /sbin/modprobe <span class="nt">-i</span> uhci_hcd <span class="p">;</span> <span class="nb">true</span>

<span class="c"># End /etc/modprobe.d/usb.conf</span>
EOF
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/34c4h.png">
</p>
<p><br></p>

<h4 id="uso-del-grub-para-configurar-el-proceso-de-arranque">Uso del GRUB para configurar el proceso de arranque</h4>

<p>Ejecutaremos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grub-install /dev/sdb

<span class="nb">cat</span> <span class="o">&gt;</span> /boot/grub/grub.cfg &lt;&lt; <span class="s2">"EOF"</span>
<span class="c"># Begin /boot/grub/grub.cfg</span>
<span class="nb">set </span><span class="nv">default</span><span class="o">=</span>0
<span class="nb">set timeout</span><span class="o">=</span>5

insmod ext2
<span class="nb">set </span><span class="nv">root</span><span class="o">=(</span>hd0,2<span class="o">)</span>

menuentry <span class="s2">"GNU/Linux, Linux 5.5.3-lfs-9.1"</span> <span class="o">{</span>
        linux   /boot/vmlinuz-5.5.3-lfs-9.1 <span class="nv">root</span><span class="o">=</span>/dev/sda2 ro
<span class="o">}</span>
EOF
</code></pre></div></div>

<p>Nos debería salir un output tal que así:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c4B.png">
</p>
<p><br></p>

<p>Eso sí… el archivo <code class="language-plaintext highlighter-rouge">grub.cfg</code> anteriormente creado deberá ser adaptado. En mi caso, tendrá estos valores:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c5s.png">
</p>
<p><br></p>

<h1 id="creando-archivos-finales">Creando archivos finales</h1>

<p>Nos estamos acercando al final. Para ir concluyendo, nos vamos a ir creando una serie de archivos finales.</p>

<p>Por un lado, nos creamos un archivo <code class="language-plaintext highlighter-rouge">lsb-release</code>, en mi caso con el siguiente contenido:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c5E.png">
</p>
<p><br></p>

<p>Por otro lado, creamos el archivo <code class="language-plaintext highlighter-rouge">os-release</code>, en mi caso con el siguiente contenido:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c5N.png">
</p>
<p><br></p>

<p>Por último, nos crearemos un archivo <code class="language-plaintext highlighter-rouge">bashrc</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> /etc/bashrc &lt;&lt; <span class="s2">"EOF"</span> 
<span class="c"># Begin /etc/bashrc</span>
<span class="c"># Written for Beyond Linux From Scratch</span>
<span class="c"># by James Robertson &lt;jameswrobertson@earthlink.net&gt;</span>
<span class="c"># updated by Bruce Dubbs &lt;bdubbs@linuxfromscratch.org&gt;</span>
<span class="c"># System wide aliases and functions.</span>
<span class="c"># System wide environment variables and startup programs should go </span>
into
<span class="c"># /etc/profile. Personal environment variables and startup programs</span>
<span class="c"># should go into ~/.bash_profile. Personal aliases and functions </span>
should
<span class="c"># go into ~/.bashrc</span>
<span class="c"># Provides colored /bin/ls and /bin/grep commands. Used in </span>
conjunction
<span class="c"># with code in /etc/profile.</span>
<span class="nb">alias ls</span><span class="o">=</span><span class="s1">'ls --color=auto'</span>
<span class="nb">alias grep</span><span class="o">=</span><span class="s1">'grep --color=auto'</span>
<span class="c"># Provides prompt for non-login shells, specifically shells started</span>
<span class="c"># in the X environment. [Review the LFS archive thread titled</span>
<span class="c"># PS1 Environment Variable for a great case study behind this script</span>
<span class="c"># addendum.]</span>
<span class="nv">NORMAL</span><span class="o">=</span><span class="s2">"</span><span class="se">\[\e</span><span class="s2">[0m</span><span class="se">\]</span><span class="s2">"</span>
<span class="nv">RED</span><span class="o">=</span><span class="s2">"</span><span class="se">\[\e</span><span class="s2">[1;31m</span><span class="se">\]</span><span class="s2">"</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s2">"</span><span class="se">\[\e</span><span class="s2">[1;32m</span><span class="se">\]</span><span class="s2">"</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$EUID</span> <span class="o">==</span> 0 <span class="o">]]</span> <span class="p">;</span> <span class="k">then
</span><span class="nv">PS1</span><span class="o">=</span><span class="s2">"</span><span class="nv">$RED</span><span class="se">\u</span><span class="s2"> [ </span><span class="nv">$NORMAL</span><span class="se">\w</span><span class="nv">$RED</span><span class="s2"> ]# </span><span class="nv">$NORMAL</span><span class="s2">"</span>
<span class="k">else
</span><span class="nv">PS1</span><span class="o">=</span><span class="s2">"</span><span class="nv">$GREEN</span><span class="se">\u</span><span class="s2"> [ </span><span class="nv">$NORMAL</span><span class="se">\w</span><span class="nv">$GREEN</span><span class="s2"> ]</span><span class="se">\$</span><span class="s2"> </span><span class="nv">$NORMAL</span><span class="s2">"</span>
<span class="k">fi
</span><span class="nb">unset </span>RED GREEN NORMAL
<span class="c"># End /etc/bashrc</span>
EOF
</code></pre></div></div>

<h1 id="arrancando-nuestra-nueva-distribución-linux-s4vios">Arrancando nuestra nueva distribución Linux S4viOS</h1>

<p>Antes de reiniciar, desmontaremos todas las monturas que teníamos previamente creadas:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>umount <span class="nt">-v</span> <span class="nv">$LFS</span>/dev/pts
umount <span class="nt">-v</span> <span class="nv">$LFS</span>/dev
umount <span class="nt">-v</span> <span class="nv">$LFS</span>/run
umount <span class="nt">-v</span> <span class="nv">$LFS</span>/proc
umount <span class="nt">-v</span> <span class="nv">$LFS</span>/sys
<span class="nb">cd</span> /
umount <span class="nt">-v</span> <span class="nv">$LFS</span>
</code></pre></div></div>

<p align="center">
     <img src="https://funkyimg.com/i/34c6r.png">
</p>
<p><br></p>

<p>Atentos al comando final:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shutdown <span class="nt">-F</span> now
</code></pre></div></div>

<p>Una vez hecho, como es de esperar… nuestra máquina virtual se habrá apagado. Ahora bien, lo que haremos será lo siguiente, como dije anteriormente de lo que definimos en el <strong>fstab</strong>, nuestro <strong>sdb</strong> se va a convertir en <strong>sda</strong>, ¿cómo?, pues simplemente quitando el disco del sistema Host con Debian.</p>

<p>Es decir, tenemos estos 2:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c6w.png">
</p>
<p><br></p>

<p>Pues lo que hacemos es quitar el <strong>Debian Base</strong>, que es con el que nos hemos construido nuestro sistema Linux residente en el otro disco. Nos debería quedar algo así:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c6x.png">
</p>
<p><br></p>

<p>¡Arranquemos la máquina virtual y veamos qué pasa!:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c6F.png">
</p>
<p><br></p>

<p>Esto tiene muy buena pinta, presionamos Enter:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c6E.png">
</p>
<p><br></p>

<p>¡Qué preciosidad!, nuestro propio sistema Linux cobrando vida, ¡vamos a iniciar sesión!:</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c6G.png">
</p>
<p><br></p>

<p>Como veis, perfectamente funcional y con total control de las cosas que hemos ido instalando (sin cosas raras):</p>

<p align="center">
     <img src="https://funkyimg.com/i/34c6H.png">
</p>
<p><br></p>

<p>Ya en este punto, podríamos continuar con la instalación y configuración de la interfaz gráfica, pero… esto lo haré en otra <strong>guía aparte</strong> siempre y cuando vea que este Gist recibe apoyo :)</p>

<p>Mientras tanto, os dejo por aquí un vídeo de mi canal de YouTube donde os enseño paso a paso a configurar un buen entorno de trabajo en Linux:</p>

<p><a href="https://www.youtube.com/watch?v=MF4qRSedmEs">https://www.youtube.com/watch?v=MF4qRSedmEs</a></p>

<p>Quién sabe, igual podremos hacer luego una fusión con <strong>S4viOS</strong>.</p>

<p>Para aquellos que por X razones quieran descargar la distribución (igual lo queréis para verificar ciertas cosas), os dejo el enlace de descarga de la máquina por aquí:</p>

<ul>
  <li><a href="https://drive.google.com/file/d/1GACSGENgHvWr2v_8JbcUieLyZAoU11qe/view?usp=sharing">https://drive.google.com/file/d/1GACSGENgHvWr2v_8JbcUieLyZAoU11qe/view?usp=sharing</a></li>
</ul>

<blockquote>
  <p><strong>Usuario de la máquina</strong>: root</p>
</blockquote>

<blockquote>
  <p><strong>Contraseña</strong>: nmapypadentro</p>
</blockquote>

<p>¡Un saludo y que os sea leve!</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#lfs" class="page__taxonomy-item" rel="tag">LFS</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#linux-from-scratch" class="page__taxonomy-item" rel="tag">Linux From Scratch</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#linux" class="page__taxonomy-item" rel="tag">Linux</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#personalizaci%C3%B3n" class="page__taxonomy-item" rel="tag">Personalización</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#s4vios" class="page__taxonomy-item" rel="tag">S4viOS</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#portswigger" class="page__taxonomy-item" rel="tag">Portswigger</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2020-04-23T00:00:00+02:00">April 23, 2020</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/oswp-preparacion/" class="pagination--pager" title="Preparación OSWP
">Previous</a>
    
    
      <a href="/antena-casera-largo-alcance/" class="pagination--pager" title="Creando una antena casera direccional de largo alcance
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2022 Aitorgg02</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
